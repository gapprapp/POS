<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>PPS Auto Group</title>

    <!-- Bootstrap Import -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.6/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Super cool dialog-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.js"></script>

    <!-- Easy-autocomplete -->
    <script src="js/jquery.easy-autocomplete.min.js"></script>
    <link rel="stylesheet" href="css/easy-autocomplete.min.css">
    <link rel="stylesheet" href="css/easy-autocomplete.themes.min.css">

    <script type="text/javascript" src="js/jquery.alphanumeric.js"></script>
    <link rel="stylesheet" href="css/easy-loading.css">
    <script src="js/easy-loading.js"></script>

    <!-- Sidbar -->
    <link href="css/simple-sidebar.css" rel="stylesheet">
    <!-- Font -->
    <link href="https://fonts.googleapis.com/css?family=Prompt" rel="stylesheet">
    <!-- Main -->
    <link href="css/untitled.css" rel="stylesheet">
    <style>
        .list-group-item {
            padding: 6px 20px;
            margin-bottom: 6px;
        }

        .no-pd{
            padding-left: 0;
            padding-right: 0;
        }
    </style>

    <script>
        var max_page_no = 0;
        $(document).ready(function () {
            $("#pg-st").addClass('disabled');
            $("#pg-nd").addClass('disabled');
            $("#pg-rd").addClass('disabled');
            $("#li-next").addClass('disabled');
            $("#li-prev").addClass('disabled');

            /*if(!localStorage.user_id){
                $.alert({
                icon: 'fa fa-warning',
                title: 'เตือน',
                content: "กรุณาเข้าสู่ระบบก่อน"
                });
                window.location = "login.html";
            } */  

            if(localStorage.role == "user"){
                $("#mb").remove();
                $("#mp").remove();
            }   

            $("#search-name").focus();
            $(document).keydown(function(objEvent) {               
                if (objEvent.keyCode == 13) {  //enter pressed
                    objEvent.preventDefault();           
                    if($("#search-tel").is(":focus") || $("#search-name").is(":focus")){
                        search();
                    }      
                }
                if (objEvent.keyCode == 113) {  //f2 pressed
                    search();
                }
                if (objEvent.keyCode == 115) {  //f4 pressed
                    add_cus();
                }
                if (objEvent.keyCode == 118) {  //f7 pressed
                    showall();          
                }
            })         
            // Get max
            var path = "http://150.95.26.163:8080/gitmew/php/get_max_cus.php";
            $.post(path, {
                'start': 0,
                "sort_by": sort_by,
                "order": order,
            }, function (data) {
                url = new URL(window.location.href);
                sl = url.searchParams.get("sl");
                max_page_no = Math.ceil(data/100);
                if(max_page_no == 2){
                    $("#pg-rd a").text("#");
                    $("#pg-rd").addClass('disabled');
                }
                if (sl == 1) {
                    // Go last page
                    pagination('last');
                } else {
                    // Get First 100
                    $.ajax({
                        type: "POST",
                        url: "http://150.95.26.163:8080/gitmew/php/get_allcus.php",
                        data: {
                            'start': 0,
                            'sort_by': sort_by,
                            'order': order
                        },
                        cache: false,
                        crossDomain: true,
                        beforeSend: function() {
                            EasyLoading.show({                           
                                text: "กำลังโหลด"                            
                            });
                            $("#pg-st").addClass('disabled');
                            $("#pg-nd").addClass('disabled');
                            $("#pg-rd").addClass('disabled');
                            $("#li-next").addClass('disabled');
                            $("#li-prev").addClass('disabled');                            
                        },
                        success: function (response) {
                            EasyLoading.hide();
                            var obj = jQuery.parseJSON(response);
                            $.each(obj, function (i, field) {            

                                text_html = "<li id='item-" + i + "' class='list-group-item text-center rounded'>" +
                                    "<span id='span-" + i + "' hidden>" + field.customer_id + "</span>" +
                                    "<div class='row'>" +
                                    "<div class='col-3' style='padding-right: 0;'>" +
                                    "<div class='input-group-prepend'>" +
                                    "<span class='input-group-text' style='margin-right: 8px;'>" + (i + 1) + "</span>" +
                                    "<input id='name-" + i + "' type='text' class='form-control text-center' value='" + field.customer_name + "' disabled>" +
                                    "</div>" +
                                    "</div>" +
                                    "<div class='col-6'>" +
                                    "<input id='addr-" + i + "' type='text' class='form-control text-center' value='" + field.address + "' disabled>" +
                                    "</div>" +
                                    "<div class='col-2' style='padding-left: 0; padding-right: 0;'>" +
                                    "<input id='tel-" + i + "' type='text' class='form-control text-center no-spin' value='" + field.tel + "' disabled>" +
                                    "</div>" +
                                    "<div class='col-1'>" +
                                    "<button id='btn-edit-" + i + "' class='btn btn-sm btn-primary' style='margin-right: 5px;' onclick='open_edit(" + i + ")'>" +
                                    "<i id='i-edit-" + i + "' class='fa fa-edit'></i>" +
                                    "</button>" +
                                    "<button id='btn-del-" + i + "' class='btn btn-sm btn-danger' onclick='del_row(" + i + ")' hidden>" +
                                    "<i id='i-del-" + i + "' class='fa fa-minus'></i>" +
                                    "</button>" +
                                    "</div>" +
                                    "</div>" +
                                    "</li>"; // end text_html
                                $(".list-group").append(text_html);
                            });
                            $("#pg-st").removeClass('disabled');
                            $("#pg-nd").removeClass('disabled');
                            $("#pg-rd").removeClass('disabled');
                            $("#li-next").removeClass('disabled');
                        }
                    });
                }
            });
        });

        function open_edit(arg) {
            $("#name-" + arg).prop('disabled', false);
            $("#addr-" + arg).prop('disabled', false);
            $("#tel-" + arg).prop('disabled', false);
            $("#btn-edit-" + arg).attr('class', 'btn btn-sm btn-success');
            $("#btn-edit-" + arg).attr('onclick', "save_edit(" + arg + ")");
            $("#i-edit-" + arg).attr('class', 'fa fa-check-square');
            $("#btn-del-" + arg).prop('hidden', false);
            $("#btn-info-" + arg).prop('hidden', true);
        }

        function del_row(arg) {
            $.confirm({
                icon: 'fa fa-warning',
                title: 'แน่ใจหรือว่าต้องการลบ!',
                content: 'ต้องการลบรายการสินค้าออกจากฐานข้อมูล!',
                buttons: {
                    danger: {
                        btnClass: 'btn-danger',
                        text: 'ลบ', // With spaces and symbols,
                        action: function () {
                            var cus_id = $("#span-" + arg).text();
                            $.ajax({
                                url: "http://150.95.26.163:8080/gitmew/php/delete_cus.php",
                                type: "POST",
                                data: {
                                    'cus_id': cus_id
                                },
                                success: function (data) {
                                    if (data == "success") {
                                        $.alert({
                                            icon: 'fa fa-warning',
                                            title: 'เตือน',
                                            content: 'รายการสินได้ถูกลบแล้ว',
                                        });
                                        $("#item-" + arg).remove();
                                    } else {
                                        $.alert({
                                            icon: 'fa fa-warning',
                                            title: 'เตือน',
                                            content: 'โปรดลองอีกครั้ง',
                                        });
                                    }
                                }
                            });
                        }
                    },
                    ยกเลิก: function () { },
                }
            });
        }

        function save_edit(arg) {
            $("#btn-edit-" + arg).attr('class', 'btn btn-sm btn-primary');
            $("#btn-edit-" + arg).attr('onclick', "open_edit(" + arg + ")");
            $("#i-edit-" + arg).attr('class', 'fa fa-edit');
            $("#btn-del-" + arg).prop('hidden', true);
            $("#btn-info-" + arg).prop('hidden', false);

            $("#name-" + arg).prop('disabled', true);
            $("#addr-" + arg).prop('disabled', true);
            $("#tel-" + arg).prop('disabled', true);

            //Ajax save prod.. ..
            var cus_id = $("#span-" + arg).text();
            var name = $("#name-" + arg).val();
            var addr = $("#addr-" + arg).val();
            var tel = $("#tel-" + arg).val();           

            $.ajax({
                url: "http://150.95.26.163:8080/gitmew/php/update_cus.php",
                type: "POST",
                data: {
                    'cus_id': cus_id,
                    'name': name,
                    'address': addr,
                    'tel': tel
                },
                success: function (data) {
                    if(data == "fail"){
                        $.alert({
                            icon: 'fa fa-warning',
                            title: 'พบปัญหา',
                            content: 'กรุณาลองอีกครั้ง',
                        });
                    }    
                }
            });
        }

        var searched_name;
        var searched_tel;
        function search() {
            $("#search-name").focus();
            searched_name = $("#search-name").val();
            searched_tel = $("#search-tel").val();

            $('#btn-search').prop('disabled', true);

            $(".list-group-item").remove();
            max_page = page = prev_page = 1;
            pagination('search');
        }

        var max_page = 1,
            prev_page = 1;

        function loadmore(arg) {
            var prev_page_start = (100 * (prev_page - 1));
            for (i = prev_page_start; i < (prev_page_start + 100); i++) {
                $("#item-" + i).prop('hidden', true);
            }

            //console.log("loadmore.. .. max_page : " + max_page + " arg : " + arg + " prev_page : " + prev_page);
            var start = (100 * (arg - 1));
            var end = arg * 100;
          
            var name = searched_name;
            var tel = searched_tel;

            // new page
            if (max_page < arg) {
                //console.log("max_page < arg");
                max_page = arg;
                prev_page = arg;
                $.ajax({
                    type: "POST",
                    url: "http://150.95.26.163:8080/gitmew/php/get_allcus.php",
                    data: {
                        'start': start,
                        "sort_by": sort_by,
                        "order": order,
                        'name': name,                       
                        'tel': tel
                    },
                    cache: false,
                    crossDomain: true,
                    beforeSend: function() {                       
                        EasyLoading.show({                           
                            text: "กำลังโหลด"                            
                        });                      
                    
                        $("#pg-st").addClass('disabled');
                        $("#pg-nd").addClass('disabled');
                        $("#pg-rd").addClass('disabled');
                        $("#li-next").addClass('disabled');
                        $("#li-prev").addClass('disabled');
                    },
                    success: function (response) {
                        EasyLoading.hide();
                        if (start == 0) {
                            //find max_item
                            var path = "http://150.95.26.163:8080/gitmew/php/get_max_cus.php";
                            $.post(path, {
                                'start': start,
                                "sort_by": sort_by,
                                "order": order,
                                'name': name,                               
                                'tel': tel
                            }, function (data) {
                                max_page_no = Math.ceil(data / 100);
                                if (max_page_no == 1) {
                                    $("#nav-pagination").prop('hidden', true);
                                } else if (max_page_no == 2) {
                                    $("#pg-rd a").text("#");
                                    $("#pg-rd").attr('class', 'page-item disabled');
                                } else {
                                    $("#nav-pagination").prop('hidden', false);
                                    $("#pg-rd a").text("3");
                                    $("#pg-rd").attr('class', 'page-item');
                                }
                            });
                        }
                        var obj = jQuery.parseJSON(response);
                        $.each(obj, function (i, field) {                          
                            text_html = "<li id='item-" + (start + i) + "' class='list-group-item text-center rounded'>" +
                                    "<span id='span-" + (start + i) + "' hidden>" + field.customer_id + "</span>" +
                                    "<div class='row'>" +
                                    "<div class='col-3' style='padding-right: 0;'>" +
                                    "<div class='input-group-prepend'>" +
                                    "<span class='input-group-text' style='margin-right: 8px;'>" + (start + i + 1) + "</span>" +
                                    "<input id='name-" + (start + i) + "' type='text' class='form-control text-center' value='" + field.customer_name + "' disabled>" +
                                    "</div>" +
                                    "</div>" +
                                    "<div class='col-6'>" +
                                    "<input id='addr-" + (start + i) + "' type='text' class='form-control text-center' value='" + field.address + "' disabled>" +
                                    "</div>" +
                                    "<div class='col-2' style='padding-left: 0; padding-right: 0;'>" +
                                    "<input id='tel-" + (start + i) + "' type='text' class='form-control text-center no-spin' value='" + field.tel + "' disabled>" +
                                    "</div>" +
                                    "<div class='col-1'>" +
                                    "<button id='btn-edit-" + (start + i) + "' class='btn btn-sm btn-primary' style='margin-right: 5px;' onclick='open_edit(" + (start + i) + ")'>" +
                                    "<i id='i-edit-" + (start + i) + "' class='fa fa-edit'></i>" +
                                    "</button>" +
                                    "<button id='btn-del-" + (start + i) + "' class='btn btn-sm btn-danger' onclick='del_row(" + (start + i) + ")' hidden>" +
                                    "<i id='i-del-" + (start + i) + "' class='fa fa-minus'></i>" +
                                    "</button>" +
                                    "</div>" +
                                    "</div>" +
                                    "</li>"; // end text_html
                            $(".list-group").append(text_html);
                        });
                        $('#btn-search').prop('disabled', false);
                        $("#pg-st").removeClass('disabled');
                        $("#pg-nd").removeClass('disabled');
                        $("#pg-rd").removeClass('disabled');
                        $("#li-next").removeClass('disabled');
                        $("#li-prev").removeClass('disabled');
                    }
                });
            }
            // old page
            else if (max_page >= arg) {
                //console.log("max_page >= arg");
                if ($("#item-" + start).length == 0) {
                    //console.log("no item");
                    $.ajax({
                        type: "POST",
                        url: "http://150.95.26.163:8080/gitmew/php/get_allcus.php",
                        data: {
                            'start': start,
                            "sort_by": sort_by,
                            "order": order,
                            'name': name,                       
                            'tel': tel
                        },
                        cache: false,
                        crossDomain: true,
                        beforeSend: function() {
                            EasyLoading.show({                           
                                text: "กำลังโหลด"                            
                            });
                            $("#pg-st").addClass('disabled');
                            $("#pg-nd").addClass('disabled');
                            $("#pg-rd").addClass('disabled');
                            $("#li-next").addClass('disabled');
                            $("#li-prev").addClass('disabled');
                        },
                        success: function (response) {
                            EasyLoading.hide();
                            if (start == 0) {
                                //find max_item
                                var path = "http://150.95.26.163:8080/gitmew/php/get_max_cus.php";
                                $.post(path, {
                                    'start': start,
                                    "sort_by": sort_by,
                                    "order": order,
                                    'name': name,                       
                                    'tel': tel
                                }, function (data) {
                                    max_page_no = Math.ceil(data / 100);
                                    if (max_page_no == 1) {
                                        $("#nav-pagination").prop('hidden', true);
                                    } else if (max_page_no == 2) {
                                        $("#pg-rd a").text("#");
                                        $("#pg-rd").attr('class', 'page-item disabled');
                                    } else {
                                        $("#nav-pagination").prop('hidden', false);
                                        $("#pg-rd a").text("3");
                                        $("#pg-rd").attr('class', 'page-item');
                                    }
                                });
                            }
                            var obj = jQuery.parseJSON(response);
                            $.each(obj, function (i, field) {                              
                                text_html = "<li id='item-" + (start + i) + "' class='list-group-item text-center rounded'>" +
                                    "<span id='span-" + (start + i) + "' hidden>" + field.customer_id + "</span>" +
                                    "<div class='row'>" +
                                    "<div class='col-3' style='padding-right: 0;'>" +
                                    "<div class='input-group-prepend'>" +
                                    "<span class='input-group-text' style='margin-right: 8px;'>" + (start + i + 1) + "</span>" +
                                    "<input id='name-" + (start + i) + "' type='text' class='form-control text-center' value='" + field.customer_name + "' disabled>" +
                                    "</div>" +
                                    "</div>" +
                                    "<div class='col-6'>" +
                                    "<input id='addr-" + (start + i) + "' type='text' class='form-control text-center' value='" + field.address + "' disabled>" +
                                    "</div>" +
                                    "<div class='col-2' style='padding-left: 0; padding-right: 0;'>" +
                                    "<input id='tel-" + (start + i) + "' type='text' class='form-control text-center no-spin' value='" + field.tel + "' disabled>" +
                                    "</div>" +
                                    "<div class='col-1'>" +
                                    "<button id='btn-edit-" + (start + i) + "' class='btn btn-sm btn-primary' style='margin-right: 5px;' onclick='open_edit(" + (start + i) + ")'>" +
                                    "<i id='i-edit-" + (start + i) + "' class='fa fa-edit'></i>" +
                                    "</button>" +
                                    "<button id='btn-del-" + (start + i) + "' class='btn btn-sm btn-danger' onclick='del_row(" + (start + i) + ")' hidden>" +
                                    "<i id='i-del-" + (start + i) + "' class='fa fa-minus'></i>" +
                                    "</button>" +
                                    "</div>" +
                                    "</div>" +
                                    "</li>"; // end text_html
                                $(".list-group").append(text_html);
                            });
                            $('#btn-search').prop('disabled', false);
                            $("#pg-st").removeClass('disabled');
                            $("#pg-nd").removeClass('disabled');
                            $("#pg-rd").removeClass('disabled');
                            $("#li-next").removeClass('disabled');
                            $("#li-prev").removeClass('disabled');
                        }
                    });
                } else if (prev_page > arg) {
                    //console.log("prev_page > arg");
                    var max = max_page * 100;
                    // show page
                    for (i = start; i < end; i++) {
                        $("#item-" + i).prop('hidden', false); //show
                    }

                    // hidden all > arg
                    for (i = end; i < max; i++) {
                        $("#item-" + i).prop('hidden', true);
                    }
                } else if (prev_page <= arg) {
                    //console.log("prev_page <= arg");
                    // show page
                    for (i = start; i < end; i++) {
                        $("#item-" + i).prop('hidden', false); //show
                    }
                    // hidden old
                    for (i = 0; i < start; i++) {
                        $("#item-" + i).prop('hidden', true);
                    }
                }
                prev_page = arg;
            }
        }

        var is_sort = {
            prod_name: '0',
            prod_type_name: '0',
            prod_cost: '0',
            prod_price: '0'
        };
        var sort_by = "none",
            order = "none";

        function click_sort(arg) {
            // clear other clicked_sort
            for (var i = 0; i < 4; i++) {
                //check
                key = Object.keys(is_sort)[i];
                if (key == arg) {
                    is_sort.key = 1;
                } else {
                    $("#i-" + key).prop('hidden', true);
                    $("#i-" + key).attr('class', 'fa fa-sort-down');
                    $("#i-" + key).css('vertical-align', 'top');

                    order = "none";
                    sort_by = "none";
                }
            }

            if ($("#i-" + arg).is(':hidden')) {
                $("#i-" + arg).prop('hidden', false);
                sort_by = arg;
                order = "asc";
            } else if ($("#i-" + arg).is(':visible') && $("#i-" + arg).hasClass('fa-sort-down')) {
                $("#i-" + arg).attr('class', 'fa fa-sort-up');
                $("#i-" + arg).css('vertical-align', 'middle');
                sort_by = arg;
                order = "desc";
            } else if ($("#i-" + arg).is(':visible') && $("#i-" + arg).hasClass('fa-sort-up')) {
                $("#i-" + arg).prop('hidden', true);
                $("#i-" + arg).attr('class', 'fa fa-sort-down');
                $("#i-" + arg).css('vertical-align', 'top');
                order = "none";
                sort_by = "none";
            }

            $(".list-group-item").remove();
            max_page = page = prev_page = 1;
            pagination('sort');
        }

        var page = 1;

        function pagination(arg) {
            //console.log("pagination arg : " + arg + " max_page_no : " + max_page_no);
            //Check all list is save
            var max = page * 100;
            var start = max - 100;
            var stop = 0;
            for (var i = start; i <= max; i++) {
                if ($("#i-edit-" + i).hasClass('fa fa-check-square')) {
                    $.alert({
                        icon: 'fa fa-warning',
                        title: 'เตือน',
                        content: 'กรุณาบันทึกสินค้าก่อนเปลี่ยนหน้า',
                    });
                    $("#pg-" + arg + " a").attr('href', "#item-" + i);
                    var go_to = $(this).attr('href').offset();
                    $('ul').stop().animate({
                        scrollTop: go_to.top
                    });

                    stop = 1;
                    break;
                }
            }
            if (stop == 1) {
                $("#pg-" + arg + " a").attr('href', "#");
                return 0;
            }

            if (arg == "sort" || arg == "search" || arg == "re") {
                // pagination when sort.. ..
                if (!$("#pg-st").hasClass('active')) $("#pg-st").attr('class', 'active');
                if ($("#pg-nd").hasClass('active')) $("#pg-nd").removeClass('active');
                if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

                page = 1;
                st = $("#pg-st a").text("1"); // 1 -> 2
                nd = $("#pg-nd a").text("2");
                rd = $("#pg-rd a").text("3");

                if (arg == "search") {
                    // clear other clicked_sort
                    for (var j = 0; j < 4; j++) {
                        key = Object.keys(is_sort)[j];
                        $("#i-" + key).prop('hidden', true);
                        $("#i-" + key).attr('class', 'fa fa-sort-down');
                        $("#i-" + key).css('vertical-align', 'top');

                        order = "none";
                        sort_by = "none";
                    }
                }
            } else if (arg == "st") {
                //console.log("st");
                if (page != 2) {
                    if (!$("#pg-nd").hasClass('active')) $("#pg-nd").attr('class', 'active');
                    if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

                    page -= 1;
                    st = $("#pg-st a").text(parseInt($("#pg-st a").text()) - 1); // 1 -> 2
                    nd = $("#pg-nd a").text(parseInt($("#pg-nd a").text()) - 1);
                    rd = $("#pg-rd a").text(parseInt($("#pg-rd a").text()) - 1);
                } else if (page == 2) {
                    if (!$("#pg-st").hasClass('active')) $("#pg-st").attr('class', 'active');
                    if ($("#pg-nd").hasClass('active')) $("#pg-nd").removeClass('active');
                    if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

                    page = 1;

                } else {
                    return 0;
                }
            } else if (arg == "nd") {

                //console.log("nd");
                if (page == 1) page++;
                else if (page == max_page_no) page--;
                if ($("#pg-nd").hasClass('active')) return 0;
                else $("#pg-nd").attr('class', 'active');
                if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
                if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');
            } else if (arg == "rd") {
                if (page + 1 == max_page_no) {
                    if (!$("#pg-rd").hasClass('active')) $("#pg-rd").attr('class', 'active');
                    if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
                    if ($("#pg-nd").hasClass('active')) $("#pg-nd").removeClass('active');

                    page = max_page_no;
                    st = $("#pg-st a").text(parseInt(max_page_no - 2));
                    nd = $("#pg-nd a").text(parseInt(max_page_no - 1));
                    rd = $("#pg-rd a").text(parseInt(max_page_no));
                } else {
                    //console.log("rd");
                    if (page == max_page_no) return 0;

                    if (!$("#pg-nd").hasClass('active')) $("#pg-nd").attr('class', 'active');
                    if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
                    if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

                    if (page == 1) page += 2; // page = 3
                    else page += 1;
                    st = $("#pg-st a").text(parseInt($("#pg-st a").text()) + 1); // 1 -> 2
                    nd = $("#pg-nd a").text(parseInt($("#pg-nd a").text()) + 1);
                    rd = $("#pg-rd a").text(parseInt($("#pg-rd a").text()) + 1);
                }
            } else if (arg == "prev") {
                //console.log("prev");
                if (page <= 11) {
                    if (!$("#pg-st").hasClass('active')) $("#pg-st").attr('class', 'active');
                    if ($("#pg-nd").hasClass('active')) $("#pg-nd").removeClass('active');
                    if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

                    page = 1;
                    st = $("#pg-st a").text("1");
                    nd = $("#pg-nd a").text("2");
                    rd = $("#pg-rd a").text("3");
                } else {
                    if (!$("#pg-nd").hasClass('active')) $("#pg-nd").attr('class', 'active');
                    if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
                    if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

                    page = page - 10;

                    st = $("#pg-st a").text(parseInt($("#pg-st a").text()) - 10);
                    nd = $("#pg-nd a").text(parseInt($("#pg-nd a").text()) - 10);
                    rd = $("#pg-rd a").text(parseInt($("#pg-rd a").text()) - 10);
                }
            } else if (arg == "next") {
                //console.log("next");
                if ($("#pg-st").hasClass('active')) {
                    if (!$("#pg-nd").hasClass('active')) $("#pg-nd").attr('class', 'active');
                    if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');

                    page = page + 10;

                    st = $("#pg-st a").text(parseInt($("#pg-st a").text()) + 9);
                    nd = $("#pg-nd a").text(parseInt($("#pg-nd a").text()) + 9);
                    rd = $("#pg-rd a").text(parseInt($("#pg-rd a").text()) + 9);
                } else {
                    if (!$("#pg-nd").hasClass('active')) $("#pg-nd").attr('class', 'active');
                    if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');

                    page = page + 10;

                    st = $("#pg-st a").text(parseInt($("#pg-st a").text()) + 10);
                    nd = $("#pg-nd a").text(parseInt($("#pg-nd a").text()) + 10);
                    rd = $("#pg-rd a").text(parseInt($("#pg-rd a").text()) + 10);
                }

            } else if (arg == "last") {
                //console.log("last");
                if (max_page_no <= 3) {
                    if (max_page_no == 2) {
                        //console.log("2");
                        if (!$("#pg-nd").hasClass('active')) $("#pg-nd").attr('class', 'active');
                        if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
                        if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

                        page = 2;
                        st = $("#pg-st a").text("1");
                        nd = $("#pg-nd a").text("2");
                        rd = $("#pg-rd a").text("#");
                    } else if (max_page_no == 3) {
                        //console.log("3");
                        if (!$("#pg-rd").hasClass('active')) $("#pg-rd").attr('class', 'active');
                        if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
                        if ($("#pg-nd").hasClass('active')) $("#pg-nd").removeClass('active');

                        page = 3;
                        st = $("#pg-st a").text("1");
                        nd = $("#pg-nd a").text("2");
                        rd = $("#pg-rd a").text("3");
                    }
                } else {
                    if (!$("#pg-rd").hasClass('active')) $("#pg-rd").attr('class', 'active');
                    if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
                    if ($("#pg-nd").hasClass('active')) $("#pg-nd").removeClass('active');

                    page = max_page_no;
                    st = $("#pg-st a").text(parseInt(max_page_no - 2));
                    nd = $("#pg-nd a").text(parseInt(max_page_no - 1));
                    rd = $("#pg-rd a").text(parseInt(max_page_no));
                }
            }

            // Un-Disabled li-prev
            if (page > 1) {
                $("#li-prev").prop('class', 'page-item');
            } else if (page == 1) {
                $("#li-prev").prop('class', 'page-item disabled');
            }

            loadmore(page);
        }

        function prev() {
            pagination('prev');
        }

        function next() {
            if (page + 10 < max_page_no) {
                pagination('next');
            } else if (page + 10 >= max_page_no) {
                pagination('last');
            }
        }

        function showall() {
            location.reload();
        }

        function add_new_cus(arg){
            // add cus to db
            // check 
            if($("#add-name-"+arg).val() != "" && $("#add-addr-"+arg).val() != "" && $("#add-tel-"+arg).val() != ""){
                var name = $('#add-name-'+arg).val();
                var addr = $('#add-addr-'+arg).val();
                var tel = $('#add-tel-'+arg).val();
                $.ajax({
                    url: "http://150.95.26.163:8080/gitmew/php/add_cus.php",
                    type: "POST",
                    data: {                     
                        'name': name,
                        'address': addr,
                        'tel': tel
                    },
                    success: function (data) {
                        if(data == "fail"){
                            $.alert({
                                icon: 'fa fa-warning',
                                title: 'เตือน',
                                content: "กรุณาลองอีกครั้ง"
                            });
                        }else{
                            //$('#add-id-'+arg).text(data);
                            $("#add-name-"+arg).prop('disabled', true);
                            $("#add-addr-"+arg).prop('disabled', true);
                            $("#add-tel-"+arg).prop('disabled', true);

                            $("#btn-add-"+arg).prop('hidden', true);
                            $("#btn-add-edit-"+arg).prop('hidden', false);
                        }                        
                    }
                });
            }else{
                $.alert({
                    icon: 'fa fa-warning',
                    title: 'เตือน',
                    content: "กรุณากรอกข้อมูลลูกค้าให้ครบถ้วน"
                });
            }
            
        }

        function edit_new_cus(arg){
            $("#add-name-"+arg).prop('disabled', false);
            $("#add-addr-"+arg).prop('disabled', false);
            $("#add-tel-"+arg).prop('disabled', false);

            $("#btn-add-save-"+arg).prop('hidden', false);
            $("#btn-add-edit-"+arg).prop('hidden', true);
            $("#btn-add-del-"+arg).prop('hidden', false);
        }

        function save_new_cus(arg){
            var cus_id = $("#add-id-" + arg).text();
            var name = $("#add-name-" + arg).val();
            var addr = $("#add-addr-" + arg).val();
            var tel = $("#add-tel-" + arg).val();           

            $.ajax({
                url: "http://150.95.26.163:8080/gitmew/php/update_cus.php",
                type: "POST",
                data: {
                    'cus_id': cus_id,
                    'name': name,
                    'address': addr,
                    'tel': tel
                },
                success: function (data) {
                    if(data == "success"){
                        $("#add-name-"+arg).prop('disabled', true);
                        $("#add-addr-"+arg).prop('disabled', true);
                        $("#add-tel-"+arg).prop('disabled', true);

                        $("#btn-add-save-"+arg).prop('hidden', true);
                        $("#btn-add-edit-"+arg).prop('hidden', false);
                        $("#btn-add-del-"+arg).prop('hidden', true);
                    }else{
                        $.alert({
                            icon: 'fa fa-warning',
                            title: 'เตือน',
                            content: "กรุณาลองอีกครั้ง"
                        });
                    }
                }
            });    
           
        }

        function del_new_cus(arg){
            console.log(arg);
            $.confirm({
                icon: 'fa fa-warning',
                title: 'แน่ใจหรือว่าต้องการลบ!',
                content: 'ต้องการลบรายการสินค้า!',
                buttons: {
                    danger: {
                        btnClass: 'btn-danger',
                        text: 'ลบ', // With spaces and symbols,
                        action: function () {
                            var cus_id = $("#add-id-" + arg).text();
                            $.ajax({
                                url: "http://150.95.26.163:8080/gitmew/php/delete_cus.php",
                                type: "POST",
                                async:false,
                                data: {
                                    'cus_id': cus_id
                                },
                                success: function (data) {
                                    if (data == "success") {
                                        $.alert({
                                            icon: 'fa fa-warning',
                                            title: 'เตือน',
                                            content: 'รายการสินได้ถูกลบแล้ว',
                                        });
                                        $("#add-"+arg).remove();
                                        for(i = arg+1; i <= add_index; i++){
                                            $("#add-"+i).prop('id', "add-"+(i-1));
                                            str = $("#add-no-"+i).text()-1;
                                            $("#add-no-"+i).text("+"+str+"");
                                            $("#add-no-"+i).prop('id', "add-no-"+(i-1));
                                            $("#add-name-"+i).prop('id', "add-name-"+(i-1));
                                            $("#add-addr-"+i).prop('id', "add-addr-"+(i-1));
                                            $("#add-tel-"+i).prop('id', "add-tel-"+(i-1));

                                            $("#btn-add-"+i).attr('onclick', "add_new_cus(" + (i - 1) + ")");
                                            $("#btn-add-save-"+i).attr('onclick', "save_new_cus(" + (i - 1) + ")");
                                            $("#btn-add-edit-"+i).attr('onclick', "edit_new_cus(" + (i - 1) + ")");
                                            $("#btn-add-del-"+i).attr('onclick', "del_new_cus(" + (i - 1) + ")");

                                            $("#btn-add-"+i).prop('id', "btn-add-"+(i-1));
                                            $("#btn-add-save-"+i).prop('id', "btn-add-save-"+(i-1));
                                            $("#btn-add-edit-"+i).prop('id', "btn-add-edit-"+(i-1));
                                            $("#btn-add-del-"+i).prop('id', "btn-add-del-"+(i-1));
                                        }
                                        add_index--;
                                    } else {
                                        $.alert({
                                            icon: 'fa fa-warning',
                                            title: 'เตือน',
                                            content: 'โปรดลองอีกครั้ง',
                                        });
                                    }
                                }
                            });
                        }
                    },
                    ยกเลิก: function () { },
                }
            });         
        }

        var add_index = 0;
        function add_cus() {

            // Check before is added
            if(add_index > 0 && $("#btn-add-"+add_index).is(':visible')){
                $("#add-"+add_index).remove();
                add_index--;
                return 0;
            }else{
                add_index++;                               
                $(".add-group").prop('hidden', false);

                var text_html = "<li id='add-"+add_index+"' class='list-group-item text-center rounded'>"+
                        "<span id='add-id-"+add_index+"' hidden></span>" +
                        "<div class='row'>"+
                            "<div class='col-3 text-center'>"+
                                "<div class='input-group-prepend'>"+
                                    "<span id='add-no-"+add_index+"' class='input-group-text' style='margin-right: 8px;'>+"+add_index+"</span>"+
                                    "<input id='add-name-"+add_index+"' type='text' class='form-control text-center'>"+
                               " </div>"+
                            "</div>"+
                            "<div class='col-6 text-center'>"+
                                "<input id='add-addr-"+add_index+"' type='text' class='form-control text-center'>"+
                            "</div>"+
                            "<div class='col-2 text-center'>"+
                                "<input id='add-tel-"+add_index+"' type='text' class='form-control text-center'>"+
                            "</div>"+
                            "<div class='col-1' text-center' style='margin-top: 3px;'>"+
                                "<button id='btn-add-"+add_index+"' class='btn btn-sm btn-success' style='margin-right: 5px;' onclick='add_new_cus("+add_index+")'>"+
                                    "<i id='i-edit-1' class='fa fa-plus'></i>"+
                                "</button>"+
                                "<button id='btn-add-save-"+add_index+"' class='btn btn-sm btn-success' style='margin-right: 5px;' onclick='save_new_cus("+add_index+")' hidden>"+
                                    "<i id='i-edit-1' class='fa fa-check-square'></i>"+
                                "</button>"+
                                "<button id='btn-add-edit-"+add_index+"' class='btn btn-sm btn-primary' style='margin-right: 5px;' onclick='edit_new_cus("+add_index+")' hidden>"+
                                    "<i id='i-edit-1' class='fa fa-edit'></i>"+
                                "</button>"+
                                "<button id='btn-add-del-"+add_index+"' class='btn btn-sm btn-danger' onclick='del_new_cus("+add_index+")' data-toggle='modal'data-target='#myModal' hidden>"+
                                    "<i id='i-del-' class='fa fa-minus'></i>"+
                                "</button>"+
                            "</div>"+
                        "</div>"+
                    "</li>";

                $('.add-group').append(text_html);
                $("#add-name-"+add_index).focus();
            }             
        }

        function logout(){
            localStorage.user_id = "";
            window.location = "login.html";
        }
    </script>
</head>

<body>
    <div id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav" style="margin-top: 20px">
                <li class="sidebar-brand"><a id="sidebar-title" href="http://150.95.26.163:8080/gitmew/sale.html">PPS Auto Group</a></li>
                <li><a href="http://150.95.26.163:8080/gitmew/import.html">๐ สินค้าเข้า</a></li>
                <li><a id="mp" href="http://150.95.26.163:8080/gitmew/manage_prod.html">๐ จัดการสินค้า</a></li>
                <li><a href="http://150.95.26.163:8080/gitmew/manage_cus.html">๐ จัดการลูกค้า</a></li>
                <li><a href="http://150.95.26.163:8080/gitmew/sale.html">๐ ทำรายการขาย</a></li>  
                <li><a id="mb" href="http://150.95.26.163:8080/gitmew/manage_bill.html">๐ รายการขายย้อนหลัง</a></li> 
                <li><a href="http://150.95.26.163:8080/gitmew/cash_record.html">๐ ตัดกะ</a></li> 
                <li><a href="http://150.95.26.163:8080/gitmew/manage_shift.html">๐ รายการตัดกะย้อนหลัง</a></li>                    
                <li><a href="#" onclick="logout()">๐ ออกจากระบบ ๐</a></li>
            </ul>
        </div>
        <!-- End sidebar -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <!-- Navbar -->
            <nav class="navbar navbar-expand-md navbar-dark mb-4 rounded" style="background: #87ceeb;">
                <div class="clearfix">
                    <a href="#menu-toggle" class="navbar-brand " id="menu-toggle">รายการ</a>
                </div>
                <div class="collapse navbar-collapse justify-content-md-center" id="navbarCollapse">
                    <h3 id="nav-title">จัดการลูกค้า</h3>
                </div>
            </nav>
            <!-- End Navbar -->
            <div class="container-fullwidth justify-content-center">
                <!-- 3 Search -->
                <div class="row" style="margin-right: 7%;">
                    <div class="col-2"></div>
                    <div class="col-3 text-center">
                         ชื่อลูกค้า
                    </div>
                    <div class="col-2 text-center">
                        เบอร์โทร
                    </div>
                    <div class="col-1 text-center no-pd">ประเภท</div>
                    <div class="col-4 text-center"></div>
                    <div class="col-1"></div>
                </div>
                <div class="row" style="margin-right: 7%;">
                    <div class="col-1"></div>
                    <div class="col-1 text-right">
                        <p style="padding-top: 5px; font-size: 120%;">ค้นหา :
                            <p/>
                    </div>
                    <div class="col-3 text-center">
                        <input id="search-name" type="text" class="form-control text-center no-spin">
                    </div>
                    <div class="col-2 text-center">
                        <input id="search-tel" type="number" class="form-control text-center">
                    </div>
                    <div class="col-1 text-center no-pd">
                        <div class="btn-group ">
                            <select id="branch" type="button" class="btn btn-secondary dropdown-toggle" aria-haspopup="true" aria-expanded="false">
                                <option class='dropdown-item text-center' style='color: #ffffff' value=''>ขายส่ง</option>
                                <option class='dropdown-item text-center' style='color: #ffffff' value=''>ขายปลีก</option>
                                <option class='dropdown-item text-center' style='color: #ffffff' value=''>ทั่วไป</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-4 text-center">
                        <button id='btn-search' class="btn btn-success btn-md" onclick="search()">ค้นหา [F2]</button>
                        <button class="btn btn-info btn-md" onclick="add_cus();">เพิ่มลูกค้า [F4]</button>
                        <button class="btn btn-primary btn-md" onclick="showall()">แสดงทั้งหมด [F7]</button>
                    </div>
                </div>
            </div>
            <hr style="width: 90%;">
            <!-- Header -->
            <div class="container-fullwidth justify-content-center" style="max-height: 100vh-70px;">
                <div class="row" style="padding-right: 40px; padding-left: 40px;">
                    <div class="col-3 text-center">
                        <a href="#" style="color: black;" onclick="click_sort('customer_name')">ชื่อลูกค้า
                            <i id="i-customer_name" class="fa fa-sort-down" style="vertical-align: top; margin-left:2px;" hidden></i>
                        </a>
                    </div>
                    <div class="col-4 text-center">
                        ที่อยู่
                    </div>
                    <div class="col-2 text-center">เบอร์โทร</div>
                    <div class="col-2 text-center">
                        <a href="#" style="color: black;" onclick="click_sort('type')">ประเภท
                            <i id="i-type" class="fa fa-sort-down" style="vertical-align: top; margin-left:2px;" hidden></i>
                        </a>
                    </div>
                    <div class="col-1 text-center"></div>
                </div>
                <br>

            <!-- Add -->
            <ul class="add-group" style="padding-right: 20px; padding-left: 20px;" hidden>
                <!-- Append text html 
                <li id='add-1' class='list-group-item text-center rounded'>
                    <div class="row">
                        <div class="col-3 text-center">
                            <div class="input-group-prepend">
                                <span class='input-group-text' style='margin-right: 8px;'>+1</span>
                                <input id="add-name-1" type="text" class="form-control text-center">
                            </div>
                        </div>
                        <div class="col-6 text-center">
                            <input id="add-addr-1" type="text" class="form-control text-center">
                        </div>
                        <div class="col-2 text-center">
                            <input id="add-tel-1" type="text" class="form-control text-center">
                        </div>
                        <div class="col-1 text-center" style="margin-top: 3px;">
                            <button id='btn-add-1' class='btn btn-sm btn-success' style='margin-right: 5px;' onclick='add_cus("1")'>
                                <i id='i-edit-1' class='fa fa-plus'></i>
                            </button>
                            <button id='btn-del-1' class='btn btn-sm btn-danger' onclick='del_row("1")' data-toggle='modal'
                                data-target='#myModal' hidden>
                                <i id='i-del-' class='fa fa-minus'></i>
                            </button>
                        </div>
                    </div>
                </li>-->
            </ul>    

                <ul class="list-group" style="padding-right: 20px; padding-left: 20px;">
                    <!-- Append text html -->
                    <li id='item-1' class='list-group-item text-center rounded'>
                        <div class="row">
                            <div class="col-3 text-center">
                                <input type="text" class="form-control">
                            </div>
                            <div class="col-4 text-center">
                                <input type="text" class="form-control">
                            </div>
                            <div class="col-2 text-center">
                                <input type="text" class="form-control">
                            </div>
                            <div class="col-2 text-center">
                                <input type="text" class="form-control">
                            </div>
                            <div class="col-1 text-center" style="margin-top: 3px;">
                                <button id='btn-edit-1' class='btn btn-sm btn-primary' style='margin-right: 3px;' onclick='open_edit("1")'>
                                    <i id='i-edit-1' class='fa fa-edit'></i>
                                </button>
                                <button id='btn-info-1' class='btn btn-sm btn-info' onclick='window.location = "pricebook.html?cid=1"'>
                                    <i id='i-info-1' class='fa fa-info-circle'></i>
                                </button>
                                <button id='btn-del-1' class='btn btn-sm btn-danger' onclick='del_row("1")' data-toggle='modal'
                                    data-target='#myModal' hidden>
                                    <i id='i-del-1' class='fa fa-minus'></i>
                                </button>
                            </div>
                        </div>
                    </li>
                </ul>
                <br>
            </div>

            <nav id="nav-pagination">
                <ul class="pagination justify-content-center">
                    <li id="li-prev" class="page-item disabled">
                        <a class="page-link" href="#" aria-label="Previous" onclick="prev();">
                            <span aria-hidden="true">&laquo;</span>
                            <span class="sr-only">Previous</span>
                        </a>
                    </li>
                    <li id="pg-st" class="page-item active">
                        <a class="page-link scroll_to" href="#" onclick="pagination('st')">1</a>
                    </li>
                    <li id="pg-nd" class="page-item">
                        <a class="page-link scroll_to" href="#" onclick="pagination('nd')">2</a>
                    </li>
                    <li id="pg-rd" class="page-item">
                        <a class="page-link scroll_to" href="#" onclick="pagination('rd')">3</a>
                    </li>
                    <li id="li-next" class="page-item">
                        <a class="page-link" href="#" aria-label="Next" onclick="next();">
                            <span aria-hidden="true">&raquo;</span>
                            <span class="sr-only">Next</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
        <!-- End page content wrapper -->
    </div>
    <!-- End Wrapper -->

    <!-- Menu Toggle -->
    <script>
        // Menu Toggle
        $("#menu-toggle").click(function (e) {
            e.preventDefault();
            $("#wrapper").toggleClass("toggled");

            if ($("#menu-toggle").text() == "รายการ") {
                $("#menu-toggle").text("กลับ");
            } else if ($("#menu-toggle").text() == "กลับ") {
                $("#menu-toggle").text("รายการ");
            }
        });
    </script>
</body>

</html>