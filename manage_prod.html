<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>PPS Auto Group</title>

  <!-- Bootstrap Import -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.6/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <!-- Super cool dialog-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.js"></script>

  <!-- Easy-autocomplete -->
  <script src="js/jquery.easy-autocomplete.min.js"></script>
  <link rel="stylesheet" href="css/easy-autocomplete.min.css">
  <link rel="stylesheet" href="css/easy-autocomplete.themes.min.css">

  <script type="text/javascript" src="js/jquery.alphanumeric.js"></script>

  <!-- Sidbar -->
  <link href="css/simple-sidebar.css" rel="stylesheet">
  <!-- Font -->
  <link href="https://fonts.googleapis.com/css?family=Prompt" rel="stylesheet">
  <!-- Main -->
  <link href="css/untitled.css" rel="stylesheet">
  <style>
    .list-group-item {
      padding: 6px 20px;
      margin-bottom: 6px;
    }

    .udl{
      text-decoration: underline;
    }

    .pt{
      cursor: pointer;
    }

    .fa-check-circle{
      color: green !important;
    }
  </style>

  <script>
    var max_page_no = 0;
    var cus_id;
    $(document).ready(function() {
      if(!localStorage.user_id){
          $.alert({
          icon: 'fa fa-warning',
          title: 'เตือน',
          content: "กรุณาเข้าสู่ระบบก่อน"
          });
          window.location = "login.html";
      }   

      if(localStorage.role == "user"){
          $.alert({
              icon: 'fa fa-warning',
              title: 'เตือน',
              content: 'ไม่อนุญาติสำหรับบุคคลทั่วไป',
          });
          window.history.back();
      }   
      var options_cus = {
        url: function(phrase) {
          return "http://150.95.26.163:8080/gitmew/php/search_cus.php";
        },
        getValue: function(element) {
          //console.log(element);
          return element.customer_name;
        },
        ajaxSettings: {
          method: "POST",
          data: {}
        },
        preparePostData: function(data) {
          data.phrase = $("#input-cus").val();
          return data;
        },
        list: {
            maxNumberOfElements: 3,
            showAnimation: {
                type: "slide",
                time: 100
            },
            hideAnimation: {
                type: "slide",
                time: 100
            },
            onChooseEvent: function() {
              cus_id = $("#input-cus").getSelectedItemData().customer_id;
            }
        },      

        };
        $("#input-cus").easyAutocomplete(options_cus);
        $('div.easy-autocomplete').removeAttr('style');

      // Get max
      var path = "http://150.95.26.163:8080/gitmew/php/get_max.php";
      $.post(path, {
        'start': 0,
        "sort_by": sort_by,
        "order": order,
      }, function(data) {
        url = new URL(window.location.href);
        sl = url.searchParams.get("sl");
        max_page_no = Math.ceil(data / 100);
        if (sl == 1) {
          // Go last page
          pagination('last');
        } else {
          // Get First 100
          $.ajax({
            type: "POST",
            url: "http://150.95.26.163:8080/gitmew/php/get_allprod.php",
            data: {
              'start': 0,
              'sort_by': sort_by,
              'order': order
            },
            cache: false,
            crossDomain: true,
            success: function(response) {

              var obj = jQuery.parseJSON(response);
              $.each(obj, function(i, field) {
                var options_type = {
                  url: function(phrase) {
                    return "http://150.95.26.163:8080/gitmew/php/search_type.php";
                  },

                  getValue: function(element) {
                    return element.prod_type_name;
                  },

                  ajaxSettings: {
                    method: "POST",
                    data: {}
                  },

                  preparePostData: function(data) {
                    data.phrase = $("#type-" + i).val();
                    return data;
                  },

                  list: {
                    maxNumberOfElements: 3,

                    showAnimation: {
                      type: "slide",
                      time: 100
                    },
                    hideAnimation: {
                      type: "slide",
                      time: 100
                    },
                  },
                  theme: "blue-light",
                };

                var options_unit = {
                  url: function(phrase) {
                    return "http://150.95.26.163:8080/gitmew/php/search_unit.php";
                  },

                  getValue: function(element) {
                    return element.unit_name;
                  },

                  ajaxSettings: {
                    method: "POST",
                    data: {}
                  },

                  preparePostData: function(data) {
                    data.phrase = $("#unit-" + i).val();
                    return data;
                  },

                  list: {
                    maxNumberOfElements: 3,

                    showAnimation: {
                      type: "slide",
                      time: 100
                    },
                    hideAnimation: {
                      type: "slide",
                      time: 100
                    },
                  },
                  theme: "blue-light",
                };

                text_html = "<li id='item-" + i + "' class='list-group-item text-center rounded'>" +
                  "<span id='span-"+i+"' hidden>"+field.prod_id+"</span>"+
                  "<div class='row'>" +
                  "<div class='col-2' style='padding-right: 0;'>" +
                  "<div class='input-group-prepend'>" +
                  "<span class='input-group-text' style='margin-right: 8px;'>" + (i + 1) + "</span>" +
                  "<input id='barcode-" + i + "' type='text' class='form-control text-center' value='" + field.barcode + "' disabled>" +
                  "</div>" +
                  "</div>" +
                  "<div class='col-3'>" +
                  "<input id='name-" + i + "' type='text' class='form-control text-center' value='" + field.prod_name + "' disabled>" +
                  "</div>" +
                  "<div class='col-1' style='padding-left: 0; padding-right: 0;'>" +
                  "<input id='type-" + i + "' type='text' class='form-control text-center no-spin' value='" + field.prod_type_name + "' disabled>" +
                  "</div>" +
                  "<div class='col-1'>" +
                  "<input id='amount-1-" + i + "' type='number' class='form-control text-center no-spin' min='0' value='" + obj[i][0] + "' disabled>" +
                  "</div>" +
                  "<div class='col-1'>" +
                  "<input id='amount-2-" + i + "' type='number' class='form-control text-center no-spin' min='0' value='" + obj[i][1] + "' disabled>" +
                  "</div>" +
                  "<div class='col-1'>" +
                  "<input id='unit-" + i + "' type='text' class='form-control text-center no-spin' value='" + field.unit_name + "' disabled>" +
                  "</div>" +
                  "<div class='col-1'>" +
                  "<input id='fund-" + i + "' type='number' class='form-control text-center no-spin' min='0' value='" + field.prod_cost + "' disabled>" +
                  "</div>" +
                  "<div class='col-1'>" +
                  "<input id='price-" + i + "' type='number' class='form-control text-center no-spin' min='0' value='" + field.prod_price + "' disabled>" +
                  "</div>" +
                  "<div class='col-1'>" +
                  "<button id='btn-edit-" + i + "' class='btn btn-sm btn-primary' style='margin-right: 5px;' onclick='open_edit(" + i + ")'>" +
                  "<i id='i-edit-" + i + "' class='fa fa-edit'></i>" +
                  "</button>" +
                  "<button id='btn-info-" + i + "' class='btn btn-info btn-sm' data-toggle='modal' data-target='#infoModal' onclick='show_info("+field.prod_id+");'>"+
                   " <i class='fa fa-info-circle'></i>"+
                  "</button>"+
                  "<button id='btn-del-" + i + "' class='btn btn-sm btn-danger' onclick='del_row(" + i + ")' hidden>" +
                  "<i id='i-del-" + i + "' class='fa fa-minus'></i>" +
                  "</button>" +
                  "</div>" +
                  "</div>" +
                  "</li>"; // end text_html
                $(".list-group").append(text_html);
                $("#type-" + i).easyAutocomplete(options_type);
                $("#unit-" + i).easyAutocomplete(options_unit);
                $('#amount-1-' + i).numeric({
                  allow: "."
                });
                $('#amount-2-' + i).numeric({
                  allow: "."
                });
                $('#fund-' + i).numeric({
                  allow: "."
                });
                $('#price-' + i).numeric({
                  allow: "."
                });
              });
            }
          });
        }
      });
    });

    function open_edit(arg) {
      $("#barcode-" + arg).prop('disabled', false);
      $("#name-" + arg).prop('disabled', false);
      $("#type-" + arg).prop('disabled', false);
      $("#amount-1-" + arg).prop('disabled', false);
      $("#amount-2-" + arg).prop('disabled', false);
      $("#unit-" + arg).prop('disabled', false);
      $("#fund-" + arg).prop('disabled', false);
      $("#price-" + arg).prop('disabled', false);
      $("#btn-edit-" + arg).attr('class', 'btn btn-sm btn-success');
      $("#btn-edit-" + arg).attr('onclick', "save_edit(" + arg + ")");
      $("#btn-info-"+arg).prop('hidden',true);
      $("#i-edit-" + arg).attr('class', 'fa fa-check-square');
      $("#btn-del-" + arg).prop('hidden', false);
    }

    function del_row(arg) {
      $.confirm({
        icon: 'fa fa-warning',
        title: 'แน่ใจหรือว่าต้องการลบ!',
        content: 'ต้องการลบรายการสินค้าออกจากฐานข้อมูล!',
        buttons: {
          danger: {
            btnClass: 'btn-danger',
            text: 'ลบ', // With spaces and symbols,
            action: function() {
              var prod_id = $("#span-"+arg).text();
              $.ajax({
                url: "http://150.95.26.163:8080/gitmew/php/delete_prod.php",
                type: "POST",
                data: {
                  'prod_id': prod_id
                },
                success: function(data) {
                  if (data == "success") {
                    $.alert({
                      icon: 'fa fa-warning',
                      title: 'เตือน',
                      content: 'รายการสินได้ถูกลบแล้ว',
                    });
                    $("#item-" + arg).remove();
                  } else {
                    $.alert({
                      icon: 'fa fa-warning',
                      title: 'เตือน',
                      content: 'โปรดลองอีกครั้ง',
                    });
                  }
                }
              });
            }
          },
          ยกเลิก: function() {},
        }
      });
    }

    function save_edit(arg) {    
      //Ajax save prod.. ..
      var prod_id = $("#span-"+arg).text();
      var barcode = $("#barcode-" + arg).val();
      var name = $("#name-" + arg).val();
      var type = $("#type-" + arg).val();
      var amt1 = $("#amount-1-" + arg).val();
      var amt2 = $("#amount-2-" + arg).val();
      var unit = $("#unit-" + arg).val();
      var fund = $("#fund-" + arg).val();
      var price = $("#price-" + arg).val();
      if (amt1 == "") {
        amt1 = 0;
      }
      if (amt2 == "") {
        amt2 = 0;
      }
     
      $.ajax({
        url: "http://150.95.26.163:8080/gitmew/php/update_prod.php",
        type: "POST",
        data: {
          'prod_id' : prod_id,
          'barcode': barcode,
          'name': name,
          'type': type,
          'amt1': amt1,
          'amt2': amt2,
          'unit': unit,
          'fund': fund,
          'price': price
        },
        success: function(data) {
          if(data == "success"){
            $("#btn-edit-" + arg).attr('class', 'btn btn-sm btn-primary');
            $("#btn-edit-" + arg).attr('onclick', "open_edit(" + arg + ")");
            $("#i-edit-" + arg).attr('class', 'fa fa-edit');
            $("#btn-del-" + arg).prop('hidden', true);
            $("#btn-info-"+arg).prop('hidden',false);

            $("#barcode-" + arg).prop('disabled', true);
            $("#name-" + arg).prop('disabled', true);
            $("#type-" + arg).prop('disabled', true);
            $("#amount-1-" + arg).prop('disabled', true);
            $("#amount-2-" + arg).prop('disabled', true);
            $("#unit-" + arg).prop('disabled', true);
            $("#fund-" + arg).prop('disabled', true);
            $("#price-" + arg).prop('disabled', true);
          }
        }
      });
    }

    var searched_name;
    var searched_type;
    var searched_barcode;

    function search() {
      searched_name = $("#search-name").val();
      searched_type = $("#search-type").val();
      searched_barcode = $("#search-barcode").val();

      $('#btn-search').prop('disabled', true);

      $(".list-group-item").remove();
      max_page = page = prev_page = 1;
      pagination('search');
    }

    var max_page = 1,
      prev_page = 1;

    function loadmore(arg) {
      var prev_page_start = (100 * (prev_page - 1));
      for (i = prev_page_start; i < (prev_page_start + 100); i++) {
        $("#item-" + i).prop('hidden', true);
      }

      //console.log("loadmore.. .. max_page : " + max_page + " arg : " + arg + " prev_page : " + prev_page);
      var start = (100 * (arg - 1));
      var end = arg * 100;

      var barcode = searched_barcode;
      var name = searched_name;
      var type = searched_type;

      // new page
      if (max_page < arg) {
        //console.log("max_page < arg");
        max_page = arg;
        prev_page = arg;
        $.ajax({
          type: "POST",
          url: "http://150.95.26.163:8080/gitmew/php/get_allprod.php",
          data: {
            'start': start,
            "sort_by": sort_by,
            "order": order,
            'name': name,
            'barcode': barcode,
            'type': type
          },
          cache: false,
          crossDomain: true,
          success: function(response) {
            if (start == 0) {
              //find max_item
              var path = "http://150.95.26.163:8080/gitmew/php/get_max.php";
              $.post(path, {
                'start': start,
                "sort_by": sort_by,
                "order": order,
                'name': name,
                'barcode': barcode,
                'type': type
              }, function(data) {
                max_page_no = Math.ceil(data / 100);
                if (max_page_no == 1) {
                  $("#nav-pagination").prop('hidden', true);
                } else if (max_page_no == 2) {
                  $("#pg-rd a").text("#");
                  $("#pg-rd").attr('class', 'page-item disabled');
                } else {
                  $("#nav-pagination").prop('hidden', false);
                  $("#pg-rd a").text("3");
                  $("#pg-rd").attr('class', 'page-item');
                }
              });
            }
            var obj = jQuery.parseJSON(response);
            $.each(obj, function(i, field) {
              var options_type = {
                url: function(phrase) {
                  return "http://150.95.26.163:8080/gitmew/php/search_type.php";
                },

                getValue: function(element) {
                  return element.prod_type_name;
                },

                ajaxSettings: {
                  method: "POST",
                  data: {}
                },

                preparePostData: function(data) {
                  data.phrase = $("#type-" + (start + i)).val();
                  return data;
                },

                list: {
                  maxNumberOfElements: 3,

                  showAnimation: {
                    type: "slide",
                    time: 100
                  },
                  hideAnimation: {
                    type: "slide",
                    time: 100
                  },
                },
                theme: "blue-light",
              };

              var options_unit = {
                url: function(phrase) {
                  return "http://150.95.26.163:8080/gitmew/php/search_unit.php";
                },

                getValue: function(element) {
                  return element.unit_name;
                },

                ajaxSettings: {
                  method: "POST",
                  data: {}
                },

                preparePostData: function(data) {
                  data.phrase = $("#unit-" + (start + i)).val();
                  return data;
                },

                list: {
                  maxNumberOfElements: 3,

                  showAnimation: {
                    type: "slide",
                    time: 100
                  },
                  hideAnimation: {
                    type: "slide",
                    time: 100
                  },
                },
                theme: "blue-light",
              };
              text_html = "<li id='item-" + (start + i) + "' class='list-group-item text-center rounded'>" +
                "<span id='span-"+(start + i)+"' hidden>"+field.prod_id+"</span>"+
                "<div class='row'>" +
                "<div class='col-2' style='padding-right: 0;'>" +
                "<div class='input-group-prepend'>" +
                "<span class='input-group-text' style='margin-right: 8px;'>" + (start + i + 1) + "</span>" +
                "<input id='barcode-" + (start + i) + "' type='text' class='form-control text-center' value='" + field.barcode + "' disabled style='font-size: 90%;'>" +
                "</div>" +
                "</div>" +
                "<div class='col-3'>" +
                "<input id='name-" + (start + i) + "' type='text' class='form-control text-center' value='" + field.prod_name + "' disabled>" +
                "</div>" +
                "<div class='col-1' style='padding-left: 0; padding-right: 0;'>" +
                "<input id='type-" + (start + i) + "' type='text' class='form-control text-center no-spin' value='" + field.prod_type_name + "' disabled style='font-size: 90%;'>" +
                "</div>" +
                "<div class='col-1'>" +
                "<input id='amount-1-" + (start + i) + "' type='number' class='form-control text-center no-spin' value='" + obj[i][0] + "' disabled>" +
                "</div>" +
                "<div class='col-1'>" +
                "<input id='amount-2-" + (start + i) + "' type='number' class='form-control text-center no-spin' value='" + obj[i][1] + "' disabled>" +
                "</div>" +
                "<div class='col-1'>" +
                "<input id='unit-" + (start + i) + "' type='text' class='form-control text-center no-spin' value='" + field.unit_name + "' disabled>" +
                "</div>" +
                "<div class='col-1'>" +
                "<input id='fund-" + (start + i) + "' type='number' class='form-control text-center no-spin' value='" + field.prod_cost + "' disabled>" +
                "</div>" +
                "<div class='col-1'>" +
                "<input id='price-" + (start + i) + "' type='number' class='form-control text-center no-spin' value='" + field.prod_price + "' disabled>" +
                "</div>" +
                "<div class='col-1'>" +
                "<button id='btn-edit-" + (start + i) + "' class='btn btn-sm btn-primary' style='margin-right: 5px;' onclick='open_edit(" + (start + i) + ")'>" +
                "<i id='i-edit-" + (start + i) + "' class='fa fa-edit'></i>" +
                "</button>" +
                "<button id='btn-info-" + (start + i) + "' class='btn btn-info btn-sm' data-toggle='modal' data-target='#infoModal' onclick='show_info("+field.prod_id+");'>"+
                   " <i class='fa fa-info-circle'></i>"+
                  "</button>"+
                "<button id='btn-del-" + (start + i) + "' class='btn btn-sm btn-danger' onclick='del_row(" + (start + i) + ")' hidden>" +
                "<i id='i-del-" + (start + i) + "' class='fa fa-minus'></i>" +
                "</button>" +
                "</div>" +
                "</div>" +
                "</li>"; // end text_html
              $(".list-group").append(text_html);
              $("#type-" + (start + i)).easyAutocomplete(options_type);
              $("#unit-" + (start + i)).easyAutocomplete(options_unit);
              $('#amount-1-' + (start + i)).numeric({
                allow: "."
              });
              $('#amount-2-' + (start + i)).numeric({
                allow: "."
              });
              $('#fund-' + (start + i)).numeric({
                allow: "."
              });
              $('#price-' + (start + i)).numeric({
                allow: "."
              });
            });
            $('#btn-search').prop('disabled', false);
          }
        });
      }
      // old page
      else if (max_page >= arg) {
        //console.log("max_page >= arg");
        if ($("#item-" + start).length == 0) {
          //console.log("no item");
          $.ajax({
            type: "POST",
            url: "http://150.95.26.163:8080/gitmew/php/get_allprod.php",
            data: {
              'start': start,
              'sort_by': sort_by,
              'order': order,
              'name': name,
              'barcode': barcode,
              'type': type
            },
            cache: false,
            crossDomain: true,
            success: function(response) {
              if (start == 0) {
                //find max_item
                var path = "http://150.95.26.163:8080/gitmew/php/get_max.php";
                $.post(path, {
                  'start': start,
                  "sort_by": sort_by,
                  "order": order,
                  'name': name,
                  'barcode': barcode,
                  'type': type
                }, function(data) {
                  max_page_no = Math.ceil(data / 100);
                  if (max_page_no == 1) {
                    $("#nav-pagination").prop('hidden', true);
                  } else if (max_page_no == 2) {
                    $("#pg-rd a").text("#");
                    $("#pg-rd").attr('class', 'page-item disabled');
                  } else {
                    $("#nav-pagination").prop('hidden', false);
                    $("#pg-rd a").text("3");
                    $("#pg-rd").attr('class', 'page-item');
                  }
                });
              }
              var obj = jQuery.parseJSON(response);
              $.each(obj, function(i, field) {
                var options_type = {
                  url: function(phrase) {
                    return "http://150.95.26.163:8080/gitmew/php/search_type.php";
                  },

                  getValue: function(element) {
                    return element.prod_type_name;
                  },

                  ajaxSettings: {
                    method: "POST",
                    data: {}
                  },

                  preparePostData: function(data) {
                    data.phrase = $("#type-" + (start + i)).val();
                    return data;
                  },

                  list: {
                    maxNumberOfElements: 3,

                    showAnimation: {
                      type: "slide",
                      time: 100
                    },
                    hideAnimation: {
                      type: "slide",
                      time: 100
                    },
                  },
                  theme: "blue-light",
                };

                var options_unit = {
                  url: function(phrase) {
                    return "http://150.95.26.163:8080/gitmew/php/search_unit.php";
                  },

                  getValue: function(element) {
                    return element.unit_name;
                  },

                  ajaxSettings: {
                    method: "POST",
                    data: {}
                  },

                  preparePostData: function(data) {
                    data.phrase = $("#unit-" + (start + i)).val();
                    return data;
                  },

                  list: {
                    maxNumberOfElements: 3,

                    showAnimation: {
                      type: "slide",
                      time: 100
                    },
                    hideAnimation: {
                      type: "slide",
                      time: 100
                    },
                  },
                  theme: "blue-light",
                };
                text_html = "<li id='item-" + (start + i) + "' class='list-group-item text-center rounded'>" +
                  "<span id='span-"+(start + i)+"' hidden>"+field.prod_id+"</span>"+
                  "<div class='row'>" +
                  "<div class='col-2' style='padding-right: 0;'>" +
                  "<div class='input-group-prepend'>" +
                  "<span class='input-group-text' style='margin-right: 8px;'>" + (start + i + 1) + "</span>" +
                  "<input id='barcode-" + (start + i) + "' type='text' class='form-control text-center' value='" + field.barcode + "' disabled style='font-size: 90%;'>" +
                  "</div>" +
                  "</div>" +
                  "<div class='col-3'>" +
                  "<input id='name-" + (start + i) + "' type='text' class='form-control text-center' value='" + field.prod_name + "' disabled>" +
                  "</div>" +
                  "<div class='col-1' style='padding-left: 0; padding-right: 0;'>" +
                  "<input id='type-" + (start + i) + "' type='text' class='form-control text-center no-spin' value='" + field.prod_type_name + "' disabled style='font-size: 90%;'>" +
                  "</div>" +
                  "<div class='col-1'>" +
                  "<input id='amount-1-" + (start + i) + "' type='number' class='form-control text-center no-spin' value='" + obj[i][0] + "' disabled>" +
                  "</div>" +
                  "<div class='col-1'>" +
                  "<input id='amount-2-" + (start + i) + "' type='number' class='form-control text-center no-spin' value='" + obj[i][1] + "' disabled>" +
                  "</div>" +
                  "<div class='col-1'>" +
                  "<input id='unit-" + (start + i) + "' type='text' class='form-control text-center no-spin' value='" + field.unit_name + "' disabled>" +
                  "</div>" +
                  "<div class='col-1'>" +
                  "<input id='fund-" + (start + i) + "' type='number' class='form-control text-center no-spin' value='" + field.prod_cost + "' disabled>" +
                  "</div>" +
                  "<div class='col-1'>" +
                  "<input id='price-" + (start + i) + "' type='number' class='form-control text-center no-spin' value='" + field.prod_price + "' disabled>" +
                  "</div>" +
                  "<div class='col-1'>" +
                  "<button id='btn-edit-" + (start + i) + "' class='btn btn-sm btn-primary' style='margin-right: 5px;' onclick='open_edit(" + (start + i) + ")'>" +
                  "<i id='i-edit-" + (start + i) + "' class='fa fa-edit'></i>" +
                  "</button>" +
                  "<button id='btn-info-" + (start + i) + "' class='btn btn-info btn-sm' data-toggle='modal' data-target='#infoModal' onclick='show_info("+field.prod_id+");'>"+
                   " <i class='fa fa-info-circle'></i>"+
                  "</button>"+
                  "<button id='btn-del-" + (start + i) + "' class='btn btn-sm btn-danger' onclick='del_row(" + (start + i) + ")' hidden>" +
                  "<i id='i-del-" + (start + i) + "' class='fa fa-minus'></i>" +
                  "</button>" +
                  "</div>" +
                  "</div>" +
                  "</li>"; // end text_html
                $(".list-group").append(text_html);
                $("#type-" + (start + i)).easyAutocomplete(options_type);
                $("#unit-" + (start + i)).easyAutocomplete(options_unit);
                $('#amount-1-' + (start + i)).numeric({
                  allow: "."
                });
                $('#amount-2-' + (start + i)).numeric({
                  allow: "."
                });
                $('#fund-' + (start + i)).numeric({
                  allow: "."
                });
                $('#price-' + (start + i)).numeric({
                  allow: "."
                });
              });
              $('#btn-search').prop('disabled', false);
            }
          });
        } else if (prev_page > arg) {
          //console.log("prev_page > arg");
          var max = max_page * 100;
          // show page
          for (i = start; i < end; i++) {
            $("#item-" + i).prop('hidden', false); //show
          }

          // hidden all > arg
          for (i = end; i < max; i++) {
            $("#item-" + i).prop('hidden', true);
          }
        } else if (prev_page <= arg) {
          //console.log("prev_page <= arg");
          // show page
          for (i = start; i < end; i++) {
            $("#item-" + i).prop('hidden', false); //show
          }
          // hidden old
          for (i = 0; i < start; i++) {
            $("#item-" + i).prop('hidden', true);
          }
        }
        prev_page = arg;
      }
    }

    var is_sort = {
      prod_name: '0',
      prod_type_name: '0',
      prod_cost: '0',
      prod_price: '0'
    };
    var sort_by = "none",
      order = "none";

    function click_sort(arg) {
      // clear other clicked_sort
      for (var i = 0; i < 4; i++) {
        //check
        key = Object.keys(is_sort)[i];
        if (key == arg) {
          is_sort.key = 1;
        } else {
          $("#i-" + key).prop('hidden', true);
          $("#i-" + key).attr('class', 'fa fa-sort-down');
          $("#i-" + key).css('vertical-align', 'top');

          order = "none";
          sort_by = "none";
        }
      }

      if ($("#i-" + arg).is(':hidden')) {
        $("#i-" + arg).prop('hidden', false);
        sort_by = arg;
        order = "asc";
      } else if ($("#i-" + arg).is(':visible') && $("#i-" + arg).hasClass('fa-sort-down')) {
        $("#i-" + arg).attr('class', 'fa fa-sort-up');
        $("#i-" + arg).css('vertical-align', 'middle');
        sort_by = arg;
        order = "desc";
      } else if ($("#i-" + arg).is(':visible') && $("#i-" + arg).hasClass('fa-sort-up')) {
        $("#i-" + arg).prop('hidden', true);
        $("#i-" + arg).attr('class', 'fa fa-sort-down');
        $("#i-" + arg).css('vertical-align', 'top');
        order = "none";
        sort_by = "none";
      }

      $(".list-group-item").remove();
      max_page = page = prev_page = 1;
      pagination('sort');
    }

    var page = 1;

    function pagination(arg) {
      //console.log("pagination arg : " + arg + " max_page_no : " + max_page_no);
      //Check all list is save
      var max = page * 100;
      var start = max - 100;
      var stop = 0;
      for (var i = start; i <= max; i++) {
        if ($("#i-edit-" + i).hasClass('fa fa-check-square')) {
          $.alert({
            icon: 'fa fa-warning',
            title: 'เตือน',
            content: 'กรุณาบันทึกสินค้าก่อนเปลี่ยนหน้า',
          });
          $("#pg-" + arg + " a").attr('href', "#item-" + i);
          var go_to = $(this).attr('href').offset();
          $('ul').stop().animate({
            scrollTop: go_to.top
          });

          stop = 1;
          break;
        }
      }
      if (stop == 1) {
        $("#pg-" + arg + " a").attr('href', "#");
        return 0;
      }

      if (arg == "sort" || arg == "search" || arg == "re") {
        // pagination when sort.. ..
        if (!$("#pg-st").hasClass('active')) $("#pg-st").attr('class', 'active');
        if ($("#pg-nd").hasClass('active')) $("#pg-nd").removeClass('active');
        if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

        page = 1;
        st = $("#pg-st a").text("1"); // 1 -> 2
        nd = $("#pg-nd a").text("2");
        rd = $("#pg-rd a").text("3");

        if (arg == "search") {
          // clear other clicked_sort
          for (var j = 0; j < 4; j++) {
            key = Object.keys(is_sort)[j];
            $("#i-" + key).prop('hidden', true);
            $("#i-" + key).attr('class', 'fa fa-sort-down');
            $("#i-" + key).css('vertical-align', 'top');

            order = "none";
            sort_by = "none";
          }
        }
      } else if (arg == "st") {
        //console.log("st");
        if (page != 2) {
          if (!$("#pg-nd").hasClass('active')) $("#pg-nd").attr('class', 'active');
          if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

          page -= 1;
          st = $("#pg-st a").text(parseInt($("#pg-st a").text()) - 1); // 1 -> 2
          nd = $("#pg-nd a").text(parseInt($("#pg-nd a").text()) - 1);
          rd = $("#pg-rd a").text(parseInt($("#pg-rd a").text()) - 1);
        } else if (page == 2) {
          if (!$("#pg-st").hasClass('active')) $("#pg-st").attr('class', 'active');
          if ($("#pg-nd").hasClass('active')) $("#pg-nd").removeClass('active');
          if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

          page = 1;

        } else {
          return 0;
        }
      } else if (arg == "nd") {

        //console.log("nd");
        if (page == 1) page++;
        else if (page == max_page_no) page--;
        if ($("#pg-nd").hasClass('active')) return 0;
        else $("#pg-nd").attr('class', 'active');
        if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
        if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');
      } else if (arg == "rd") {
        if (page + 1 == max_page_no) {
          if (!$("#pg-rd").hasClass('active')) $("#pg-rd").attr('class', 'active');
          if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
          if ($("#pg-nd").hasClass('active')) $("#pg-nd").removeClass('active');

          page = max_page_no;
          st = $("#pg-st a").text(parseInt(max_page_no - 2));
          nd = $("#pg-nd a").text(parseInt(max_page_no - 1));
          rd = $("#pg-rd a").text(parseInt(max_page_no));
        } else {
          //console.log("rd");
          if(page == max_page_no) return 0;

          if (!$("#pg-nd").hasClass('active')) $("#pg-nd").attr('class', 'active');
          if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
          if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

          if (page == 1) page += 2; // page = 3
          else page += 1;
          st = $("#pg-st a").text(parseInt($("#pg-st a").text()) + 1); // 1 -> 2
          nd = $("#pg-nd a").text(parseInt($("#pg-nd a").text()) + 1);
          rd = $("#pg-rd a").text(parseInt($("#pg-rd a").text()) + 1);
        }
      } else if (arg == "prev") {
        //console.log("prev");
        if (page <= 11) {
          if (!$("#pg-st").hasClass('active')) $("#pg-st").attr('class', 'active');
          if ($("#pg-nd").hasClass('active')) $("#pg-nd").removeClass('active');
          if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

          page = 1;
          st = $("#pg-st a").text("1");
          nd = $("#pg-nd a").text("2");
          rd = $("#pg-rd a").text("3");
        } else {
          if (!$("#pg-nd").hasClass('active')) $("#pg-nd").attr('class', 'active');
          if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
          if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

          page = page - 10;

          st = $("#pg-st a").text(parseInt($("#pg-st a").text()) - 10);
          nd = $("#pg-nd a").text(parseInt($("#pg-nd a").text()) - 10);
          rd = $("#pg-rd a").text(parseInt($("#pg-rd a").text()) - 10);
        }
      } else if (arg == "next") {
        //console.log("next");
        if ($("#pg-st").hasClass('active')) {
          if (!$("#pg-nd").hasClass('active')) $("#pg-nd").attr('class', 'active');
          if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');

          page = page + 10;

          st = $("#pg-st a").text(parseInt($("#pg-st a").text()) + 9);
          nd = $("#pg-nd a").text(parseInt($("#pg-nd a").text()) + 9);
          rd = $("#pg-rd a").text(parseInt($("#pg-rd a").text()) + 9);
        } else {
          if (!$("#pg-nd").hasClass('active')) $("#pg-nd").attr('class', 'active');
          if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');

          page = page + 10;

          st = $("#pg-st a").text(parseInt($("#pg-st a").text()) + 10);
          nd = $("#pg-nd a").text(parseInt($("#pg-nd a").text()) + 10);
          rd = $("#pg-rd a").text(parseInt($("#pg-rd a").text()) + 10);
        }

      } else if (arg == "last") {
        //console.log("last");
        if (max_page_no <= 3) {
          if (max_page_no == 2) {
            //console.log("2");
            if (!$("#pg-nd").hasClass('active')) $("#pg-nd").attr('class', 'active');
            if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
            if ($("#pg-rd").hasClass('active')) $("#pg-rd").removeClass('active');

            page = 2;
            st = $("#pg-st a").text("1");
            nd = $("#pg-nd a").text("2");
            rd = $("#pg-rd a").text("3");
          } else if (max_page_no == 3) {
            //console.log("3");
            if (!$("#pg-rd").hasClass('active')) $("#pg-rd").attr('class', 'active');
            if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
            if ($("#pg-nd").hasClass('active')) $("#pg-nd").removeClass('active');

            page = 3;
            st = $("#pg-st a").text("1");
            nd = $("#pg-nd a").text("2");
            rd = $("#pg-rd a").text("3");
          }
        } else {
          if (!$("#pg-rd").hasClass('active')) $("#pg-rd").attr('class', 'active');
          if ($("#pg-st").hasClass('active')) $("#pg-st").removeClass('active');
          if ($("#pg-nd").hasClass('active')) $("#pg-nd").removeClass('active');

          page = max_page_no;
          st = $("#pg-st a").text(parseInt(max_page_no - 2));
          nd = $("#pg-nd a").text(parseInt(max_page_no - 1));
          rd = $("#pg-rd a").text(parseInt(max_page_no));
        }
      }

      // Un-Disabled li-prev
      if (page > 1) {
        $("#li-prev").prop('class', 'page-item');
      } else if (page == 1) {
        $("#li-prev").prop('class', 'page-item disabled');
      }

      loadmore(page);
    }

    function prev() {
      pagination('prev');
    }

    function next() {
      if (page + 10 < max_page_no) {
        pagination('next');
      } else if (page + 10 >= max_page_no) {
        pagination('last');
      }
    }

    function showall() {
      location.reload();
    }

    function add_prod() {
      window.location = "add_prod.html?mng=1";
    }
    
    function logout(){
      localStorage.user_id = "";
      window.location = "login.html";
    }

    var prod_id;
    unit_get = [];
    cus_get = [];
    function show_info(arg){
      // ajax get data for show in moodal
      prod_id = arg;    
      $.ajax({
        url: "http://150.95.26.163:8080/gitmew/php/get_prod_info.php",
        type: "POST",
        data: {
          'prod_id' : prod_id,        
        },
        //async:false,
        success: function(data) { 
            //console.log(data);
            $("#show-amt-container").empty();     
            $("#show-cus-container").empty(); 
            c_cus = 0;   
            c_unit = 0; 
            unit_get = [];
            cus_get = [];             
            if(data != "null"){
              var obj = jQuery.parseJSON(data);
              //console.log(obj);                        
              $.each(obj, function(i, field){
                if(i == obj.length-1){
                  $("#row-img").prop('hidden', false);
                  $("#img").attr('src', obj[i].img_string);
                  $('#fileSelect').data('img', obj[i].img_string);
                }else{
                  if(!field.prod_price){                    
                    c_cus++;
                    start_cus = c_cus;
                    start_cus++;
                    if(c_cus == 1){
                      header = "<div id='head-seted-cus' class='row'>" +
                        "<div class='col-3'></div>" +
                        "<div class='col-3 text-center'>ชื่อลูกค้า</div>" +
                        "<div class='col-2 text-center'>ราคา</div>" +
                        "<div class='col-1'></div>" +
                        "<div class='col-3'></div> <hr style='width: 65%'></div> ";
                      $("#show-cus-container").append(header);  
                    }                                            

                    var text_html = "<div id='show-seted-cus-" + c_cus + "' class='row'>" +
                      "<span id='span-cus-"+c_cus+"' hidden>"+field.customer_id+"</span>" +
                      "<div class='col-3'></div>" +
                      "<div id='show-cus-" + c_cus + "' class='col-3 text-center'>"+field.prod_id+"</div>" +
                      "<div id='show-cus-price-" + c_cus + "' class='col-2 text-center'>"+ field.special_prod_price +"</div>" +
                      "<div class='col-1'><i id='cus-del-" + c_cus + "' class='fa fa-close' style='color: red' onclick='delrow_cus(" + c_cus + ");' hidden></i><i id='cus-check-" + c_cus + "' class='fa fa-check' style='color: green' onclick='checkrow_cus(" + c_cus + ");' hidden></i></div>" +
                      "<div class='col-3'></div> <hr style='width: 45%'></div> ";
                    $("#show-cus-container").append(text_html);
                    cus_get.push({old_cus:field.customer_id,
                    cus_id:field.customer_id,
                    cus_price:field.special_prod_price});
                  }else{                   
                    c_unit++;
                    start_unit = c_unit;
                    start_unit++;
                    if(c_unit == 1){
                        header = "<div id='head-seted-amt' class='row'>" +
                        "<div class='col-3'></div>" +
                        "<div class='col-3 text-center'>จำนวน</div>" +
                        "<div class='col-2 text-center'>ราคา</div>" +
                        "<div class='col-1'></div>" +
                        "<div class='col-3'></div> <hr style='width: 65%'></div> ";
                      $("#show-amt-container").append(header);
                    }
                    
                    var text_html = "<div id='show-seted-amt-" + c_unit + "' class='row'>" +
                      "<div class='col-3'></div>" +
                      "<div id='show-unit-" + c_unit + "' class='col-3 text-center'>" + field.amt_threshold + "</div>" +
                      "<div id='show-unit-price-" + c_unit + "' class='col-2 text-center'>" + field.prod_price + "</div>" +
                      "<div class='col-1'><i id='unit-del-" + c_unit + "' class='fa fa-close' style='color: red' onclick='delrow_amt(" + c_unit + ");' hidden></i><i id='unit-check-" + c_unit + "' class='fa fa-check' style='color: green' onclick='checkrow_unit(" + c_unit + ");' hidden></i></div>" +
                      "<div class='col-3'></div> <hr style='width: 45%'></div> ";
                    $("#show-amt-container").append(text_html);
                    unit_get.push({old_unit:field.amt_threshold,
                    unit:field.amt_threshold,
                    unit_price:field.prod_price});
                  }
                }
              });            
            }
        }
      });  
    }

    function readURL(input) {
      if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function(e) {
          $("#row-img").prop('hidden', false);
          $("#img").attr('src', e.target.result);
          $('#fileSelect').data('img', e.target.result);
        };
        reader.readAsDataURL(input.files[0]);
      }
    }

    var c_unit = 0;
    var start_unit = 0;     
    function add_unit() {
      if($("#input-unit-price").val() == ""){
        $.alert({
          icon: 'fa fa-warning',
          title: 'เตือน',
          content: 'กรุณากรอกข้อมูลให้ครบถ้วน',
        });
        return 0;
      }        
      c_unit++;       
      // Radio is checked
      var exist = false;
      $('input[type="radio"]').each(function() {
        if($(this).is(":checked")){
          //alert($(this).val());
          number = $(this).val();
          price = $("#input-unit-price").val();
          // Exist Check
          for(var i = 1; i <= c_unit; i++){
            if(number == $("#show-unit-"+i).text() || number == $("#set-unit-"+i).val()){
              $.alert({
                icon: 'fa fa-warning',
                title: 'เตือน',
                content: "ได้ตั้งค่าราคาของจำนวน " + number + " ไว้แล้ว",
              });
              exist = true;
            }
          }
          if(exist == false){
            if (c_unit == 1) {
              header = "<div id='head-seted-amt' class='row'>" +
                "<div class='col-3'></div>" +
                "<div class='col-3 text-center'>จำนวน</div>" +
                "<div class='col-2 text-center'>ราคา</div>" +
                "<div class='col-1'></div>" +
                "<div class='col-3'></div> <hr style='width: 65%'></div> ";
              $("#show-amt-container").append(header);
            }

            var text_html = "<div id='show-seted-amt-" + c_unit + "' class='row'>" +
              "<div class='col-3'></div>" +
              "<div id='show-unit-" + c_unit + "' class='col-3 text-center'>"+ number +"</div>" +
              "<div id='show-unit-price-" + c_unit + "' class='col-2 text-center'>"+ price +"</div>" +
              "<div class='col-1'><i id='unit-del-" + c_unit + "' class='fa fa-close' style='color: red' onclick='delrow_amt(" + c_unit + ");' hidden></i><i id='unit-check-" + c_unit + "' class='fa fa-check' style='color: green' onclick='checkrow_unit(" + c_unit + ");' hidden></i></div>" +
              "<div class='col-3'></div> <hr style='width: 45%'></div> ";
            $("#show-amt-container").append(text_html);
          }
          $(this).prop("checked", false);
        }
      });

      var isDisabled = $("#input-unit").prop('disabled');
      if(!isDisabled){
        number = $("#input-unit").val();
        for(var i = 1; i <= c_unit; i++){
          if(number == $("#show-unit-"+i).text() || number == $("#set-unit-"+i).val()){
            if(number == ""){
              $.alert({
                icon: 'fa fa-warning',
                title: 'เตือน',
                content: "กุรณากรอกจำนวน",
              });
            }else{
              $.alert({
                icon: 'fa fa-warning',
                title: 'เตือน',
                content: "ได้ตั้งค่าราคาของจำนวน " + number + " ไว้แล้ว",
              });
            }
            exist = true;
          }
        }
        if(exist == false){
          if (c_unit == 1) {
            header = "<div id='head-seted-amt' class='row'>" +
              "<div class='col-3'></div>" +
              "<div class='col-3 text-center'>จำนวน</div>" +
              "<div class='col-2 text-center'>ราคา</div>" +
              "<div class='col-1'></div>" +
              "<div class='col-3'></div> <hr style='width: 65%'></div> ";
            $("#show-amt-container").append(header);
          }

          var text_html = "<div id='show-seted-amt-" + c_unit + "' class='row'>" +
            "<div class='col-3'></div>" +
            "<div id='show-unit-" + c_unit + "' class='col-3 text-center'>" + number + "</div>" +
            "<div id='show-unit-price-" + c_unit + "' class='col-2 text-center'>" +  $("#input-unit-price").val() + "</div>" +
            "<div class='col-1'><i id='unit-del-" + c_unit + "' class='fa fa-close' style='color: red' onclick='delrow_amt(" + c_unit + ");' hidden></i><i id='unit-check-" + c_unit + "' class='fa fa-check' style='color: green' onclick='checkrow_unit(" + c_unit + ");' hidden></i></div>" +
            "<div class='col-3'></div> <hr style='width: 45%'></div> ";
          $("#show-amt-container").append(text_html);
          $("#input-unit").val("");
        }
      }
      $("#input-unit-price").val("");
      $("#input-unit").removeAttr('disabled');
    }

    function edit_unit(){ 
      var all_unit = 0;
      for(var i = 1; i <= c_unit; i++){
        if($("#set-unit-"+i).is(':visible')){          
               
        }else{
          all_unit++;
        }      
      }     
      for(var i = 1; i <= c_unit; i++){
        if($("#set-unit-"+i).is(':visible')){              
          checkrow_unit(i);         
        }else if(all_unit == c_unit){
          var text = $("#show-unit-"+i).text();
          $("#show-unit-"+i).text("");
          var text_html = "<input id='set-unit-"+i+"' type='text' class='form-control text-center' value='"+text+"'>";
          $("#show-unit-"+i).append(text_html);

          var text = $("#show-unit-price-"+i).text();
          $("#show-unit-price-"+i).text("");
          var text_html = "<input id='set-unit-price-"+i+"' type='number' class='form-control text-center' value='"+text+"'>";
          $("#show-unit-price-"+i).append(text_html);

          $("#unit-del-"+i).prop('hidden', true);
          $("#unit-check-"+i).prop('hidden', false);
        }      
      }
    }
    
    function del_unit(){
      var all_unit = 0;
      var check = false;
      for(var i = 1; i <= c_unit; i++){
        if($("#set-unit-"+i).is(':visible')){          
            check = true;   
        }    
      }     
      for(var i = 1; i <= c_unit; i++){
        if($("#unit-del-"+i).is(':visible')){          
               
        }else{
          all_unit++;
        }      
      }    
      if(check){
        return 0;
      } 
      for(var i = 1; i <= c_unit; i++){
        if($("#unit-del-"+i).is(':visible')){
          $("#unit-del-"+i).prop('hidden', true);
        }else if(all_unit == c_unit){
          $("#unit-del-"+i).prop('hidden', false);
          $("#unit-check-"+i).prop('hidden', true);
        }        
      }     
    }

    function delrow_amt(arg) {
      if(arg < start_unit){
        $.confirm({
          icon: 'fa fa-warning',
          title: 'แน่ใจหรือว่าต้องการลบ!',
          content: 'ต้องการลบรายการจำนวนออกจากรายการ!',
          buttons: {
            danger: {
              btnClass: 'btn-danger',
              text: 'ลบ',
              action: function () {
                $.ajax({
                  url: "http://150.95.26.163:8080/gitmew/php/delete_unit_detail.php",
                  type: "POST",
                  data: {
                    'old_unit' : unit_get[arg-1].old_unit,               
                    'prod_id': prod_id,          
                  },
                  success: function(data) {
                    console.log(data);
                    if(data == "success"){
                      var count = $("#show-amt-container").children().length;
                      if (count == 2) {
                        $("#head-seted-amt").remove();
                        //c_unit = 0;
                      }
                      $("#unit-del-" + arg).closest('.row').remove();
                    }
                  }
                });                
              }
            },
            ยกเลิก: function () { },
          }
        });
      }else if(arg >= start_unit){
        $.confirm({
          icon: 'fa fa-warning',
          title: 'แน่ใจหรือว่าต้องการลบ!',
          content: 'ต้องการลบรายการจำนวนออกจากรายการ!',
          buttons: {
            danger: {
              btnClass: 'btn-danger',
              text: 'ลบ',
              action: function () {
                var count = $("#show-amt-container").children().length;
                if (count == 2) {
                  $("#head-seted-amt").remove();
                  //c_unit = 0;
                }
                $("#unit-del-" + arg).closest('.row').remove();
              }
            },
            ยกเลิก: function () { },
          }
        });
      }
     
    }

    function checkrow_unit(arg) {
        var unit = $("#set-unit-"+arg).val();
        var price = $("#set-unit-price-"+arg).val();
      
        for(var i = 1; i <= c_unit; i++){
          if(i != arg && (unit == $("#show-unit-"+i).text() || unit == $("#set-unit-"+i).val())){          
            $.alert({
              icon: 'fa fa-warning',
              title: 'เตือน',
              content: "ได้ตั้งค่าราคาของจำนวน " + unit + " ไว้แล้ว",
            });
            return 0;
          }
        }
      
        $("#set-unit-"+arg).remove();
        $("#set-unit-price-"+arg).remove();

        $("#show-unit-"+arg).text(unit);
        $("#show-unit-price-"+arg).text(price);

        //$("#unit-del-"+arg).prop('hidden', false);
        $("#unit-check-"+arg).prop('hidden', true);
      }
    
    unit_add = [];    
    function save_unit(){
      //console.log(start_unit);
      for(var u = 1; u < start_unit; u++){
        unit_get[u-1].unit = $("#show-unit-"+u).text();
        unit_get[u-1].unit_price = $("#show-unit-price-"+u).text();         
      } 
      unit_add = [];
      for(var v = start_unit; v <= c_unit; v++){        
        unit_add.push({unit:$("#show-unit-"+v).text(),
        unit_price:$("#show-unit-price-"+v).text()});           
      } 
      final_unit_get = [];
      for(var w = 0; w < unit_get.length; w++){        
        if(unit_get[w].unit != ""){
          final_unit_get.push({old_unit:unit_get[w].old_unit,
          unit:unit_get[w].unit,
          unit_price:unit_get[w].unit_price
          });
        }
      } 
      final_unit_add = [];
      for(var w = 0; w < unit_add.length; w++){        
        if(unit_add[w].unit != ""){
          final_unit_add.push({unit:unit_add[w].unit,
          unit_price:unit_add[w].unit_price
          });
        }
      } 
      var str_uget = JSON.stringify(final_unit_get);   
      var str_uadd = JSON.stringify(final_unit_add);    
      console.log(str_uget + str_uadd);
      if(final_unit_add.length == 0 && final_unit_get.length == 0){
        return 0;
      } 
      $.ajax({
        url: "http://150.95.26.163:8080/gitmew/php/add_unit_detail.php",
        type: "POST",
        data: {
          'JSON_uget' : str_uget,
          'JSON_uadd': str_uadd,
          'prod_id': prod_id,          
        },
        success: function(data) {
          console.log(data);
          if(data == "success"){
            show_info(prod_id);
          }
        }
      });
    }
    var c_cus = 0;
    var start_cus = 0;  
    function add_cus() {
        if($("#input-cus").val() == "" || $("#input-cus-price").val() == ""){
          $.alert({
            icon: 'fa fa-warning',
            title: 'เตือน',
            content: "กรุณากรอกข้อมูลให้ครบถ้วน",
          });
          return 0;
        }

      var exist = false;
      for (var i = 1; i <= c_cus; i++) {
        if ($("#input-cus").val() == $("#show-cus-" + i).text() || $("#input-cus").val() == $("#set-cus-" + i).val()) {
          $.alert({
            icon: 'fa fa-warning',
            title: 'เตือน',
            content: "ได้ตั้งค่าราคาของลูกค้า " + $("#input-cus").val() + " ไว้แล้ว",
          });
          exist = true;
        }
      }
      
      if(exist){
        return 0;
      }else{
        c_cus++;
        if (c_cus == 1) {
          header = "<div id='head-seted-cus' class='row'>" +
            "<div class='col-3'></div>" +
            "<div class='col-3 text-center'>ชื่อลูกค้า</div>" +
            "<div class='col-2 text-center'>ราคา</div>" +
            "<div class='col-1'></div>" +
            "<div class='col-3'></div> <hr style='width: 65%'></div> ";
          $("#show-cus-container").append(header);
        }

        var text_html = "<div id='show-seted-cus-" + c_cus + "' class='row'>" +
          "<span id='span-cus-"+c_cus+"' hidden>"+cus_id+"</span>" +
          "<div class='col-3'></div>" +
          "<div id='show-cus-" + c_cus + "' class='col-3 text-center'></div>" +
          "<div id='show-cus-price-" + c_cus + "' class='col-2 text-center'></div>" +
          "<div class='col-1'><i id='cus-del-" + c_cus + "' class='fa fa-close' style='color: red' onclick='delrow_cus(" + c_cus + ");' hidden></i><i id='cus-check-" + c_cus + "' class='fa fa-check' style='color: green' onclick='checkrow_cus(" + c_cus + ");' hidden></i></div>" +
          "<div class='col-3'></div> <hr style='width: 45%'></div> ";
        $("#show-cus-container").append(text_html);

        cus = $("#input-cus").val();
        price = $("#input-cus-price").val();

        $("#show-cus-" + c_cus).text(cus);
        $("#show-cus-price-" + c_cus).text(price);

        $("#input-cus").val("");
        $("#input-cus-price").val("");
      }
    }

    function edit_cus(){ 
      option = [];   
      var all_cus = 0;
      for(var i = 1; i <= c_cus; i++){
        if($("#set-cus-"+i).is(':visible')){          
               
        }else{
          all_cus++;
        }      
      }     
      for(var i = 1; i <= c_cus; i++){
        if($("#set-cus-"+i).is(':visible')){              
          checkrow_cus(i);         
        }else if(all_cus == c_cus){         
          var text = $("#show-cus-"+i).text();
          $("#show-cus-"+i).text("");
          var text_html = "<input id='set-cus-"+i+"' type='text' class='form-control text-center' value='"+text+"'>";
          $("#show-cus-"+i).append(text_html);
      
          var text = $("#show-cus-price-"+i).text();
          $("#show-cus-price-"+i).text("");
          var text_html = "<input id='set-cus-price-"+i+"' type='number' class='form-control text-center' value='"+text+"'>";
          $("#show-cus-price-"+i).append(text_html);
    
          $("#cus-del-"+i).prop('hidden', true);
          $("#cus-check-"+i).prop('hidden', false);
       
          option[i] = {

            url: function(phrase) {
              return "http://150.95.26.163:8080/gitmew/php/search_cus.php";
            },

            getValue: function(element) {
              //console.log(element);
              return element.customer_name;
            },

            ajaxSettings: {
              method: "POST",
              data: {}
            },

            preparePostData: function(data) {
              console.log(i);
              data.phrase = $("#set-cus-"+i).val();
              //console.log(data.phrase);
              return data;
            },

            list: {
                maxNumberOfElements: 3,

                showAnimation: {
                    type: "slide",
                    time: 100
                },
                hideAnimation: {
                    type: "slide",
                    time: 100
                },

                onChooseEvent: function() {
                  console.log(i);
                  $("#span-cus-"+i).text($("#set-cus-"+i).getSelectedItemData().customer_id);
                }
            },      

          };
         
          $("#set-cus-"+i).easyAutocomplete(option[i]);     
        }      
      }
    }
    
    function del_cus(){
      var all_cus = 0;
      var check = false;
      for(var i = 1; i <= c_cus; i++){
        if($("#set-cus-"+i).is(':visible')){          
            check = true;   
        }    
      }     
      for(var i = 1; i <= c_cus; i++){
        if($("#cus-del-"+i).is(':visible')){          
               
        }else{
          all_cus++;
        }      
      }    
      if(check){
        return 0;
      } 
      for(var i = 1; i <= c_cus; i++){
        if($("#cus-del-"+i).is(':visible')){
          $("#cus-del-"+i).prop('hidden', true);
        }else if(all_cus == c_cus){
          $("#cus-del-"+i).prop('hidden', false);
          $("#cus-check-"+i).prop('hidden', true);
        }        
      }     
    }
   
    function delrow_cus(arg) {
      if(arg < start_cus){
        $.confirm({
          icon: 'fa fa-warning',
          title: 'แน่ใจหรือว่าต้องการลบ!',
          content: 'ต้องการลบรายการลูกค้าออกจากรายการ!',
          buttons: {
            danger: {
              btnClass: 'btn-danger',
              text: 'ลบ',
              action: function () {
                $.ajax({
                  url: "http://150.95.26.163:8080/gitmew/php/delete_cus_detail.php",
                  type: "POST",
                  data: {
                    'old_cus' : cus_get[arg-1].old_cus,               
                    'prod_id': prod_id,          
                  },
                  success: function(data) {
                    console.log(data);
                    if(data == "success"){
                      var count = $("#show-cus-container").children().length;
                      if (count == 2) {
                        $("#head-seted-cus").remove();
                        //c_cus--;
                      }
                      $("#cus-del-" + arg).closest('.row').remove();
                    }
                  }
                });                
              }
            },
            ยกเลิก: function () { },
          }
        });
      }else if(arg >= start_cus){
        $.confirm({
          icon: 'fa fa-warning',
          title: 'แน่ใจหรือว่าต้องการลบ!',
          content: 'ต้องการลบรายการลูกค้าออกจากรายการ!',
          buttons: {
            danger: {
              btnClass: 'btn-danger',
              text: 'ลบ',
              action: function () {
                var count = $("#show-cus-container").children().length;
                if (count == 2) {
                  $("#head-seted-cus").remove();
                  //c_cus--;
                }
                $("#cus-del-" + arg).closest('.row').remove();
              }
            },
            ยกเลิก: function () { },
          }
        });
      }      
    }

    function checkrow_cus(arg) {
      var cus = $("#set-cus-"+arg).val();
      var price = $("#set-cus-price-"+arg).val();

      for(var i = 1; i <= c_cus; i++){
        if(i != arg && (cus == $("#show-cus-"+i).text() || cus == $("#set-cus-"+i).val())){
          $.alert({
            icon: 'fa fa-warning',
            title: 'เตือน',
            content: "ได้ตั้งค่าราคาของลูกค้า " + cus + " ไว้แล้ว",
          });
          return 0;
        }
      }

      $("#set-cus-"+arg).remove();
      $("#set-cus-price-"+arg).remove();

      $("#show-cus-"+arg).text(cus);
      $("#show-cus-price-"+arg).text(price);

      //$("#cus-del-"+arg).prop('hidden', false);
      $("#cus-check-"+arg).prop('hidden', true);
    }  
   
    cus_add = [];  
    function save_cus(){     
      for(var c = 1; c < start_cus; c++){
        cus_get[c-1].cus_id = $("#span-cus-"+c).text();
        cus_get[c-1].cus_price = $("#show-cus-price-"+c).text();      
      } 
      cus_add = [];
      for(var d = start_cus; d <= c_cus; d++){        
        cus_add.push({cus_id:$("#span-cus-"+d).text(),
        cus_price:$("#show-cus-price-"+d).text()});            
      } 
      final_cus_get = [];
      for(var w = 0; w < cus_get.length; w++){        
        if(cus_get[w].cus_id != ""){
          final_cus_get.push({old_cus:cus_get[w].old_cus,
          cus_id:cus_get[w].cus_id,
          cus_price:cus_get[w].cus_price
          });
        }
      } 
      final_cus_add = [];
      for(var w = 0; w < cus_add.length; w++){        
        if(cus_add[w].cus_id != ""){
          final_cus_add.push({cus_id:cus_add[w].cus_id,
          cus_price:cus_add[w].cus_price
          });
        }
      } 
      var str_cget = JSON.stringify(final_cus_get);   
      var str_cadd = JSON.stringify(final_cus_add);    
      console.log(str_cget + str_cadd);  
      if(final_cus_add.length == 0 && final_cus_get.length == 0){
        return 0;
      } 
      $.ajax({
        url: "http://150.95.26.163:8080/gitmew/php/add_cus_detail.php",
        type: "POST",
        data: {
          'JSON_cget' : str_cget,
          'JSON_cadd': str_cadd,
          'prod_id': prod_id,          
        },
        success: function(data) {
          console.log(data);
          if(data == "success"){
            show_info(prod_id);
          }
        }
      }); 
    }

    function save_pic(){
      var input = document.getElementById("fileSelect");
      var file = input.files[0];
      if (file == undefined) {
        return 0;         
      }else{
        if (file.size < 15000000) {
          var image = $("#fileSelect").data('img')
          $.ajax({
            url: "http://150.95.26.163:8080/gitmew/php/update_img.php",
            type: "POST",
            data: {
              'prod_id' : prod_id,              
              'img': image
            },
            success: function(data) {
              if(data == "success"){
                //$("#row-img").prop('hidden', true);
                //$("#img").attr("src","");
                //$('#fileSelect').data('img', '');
                $(".file-upload").removeClass('active');
                $("#noFile").text("วางไฟล์ที่นี่.. ..");
                $("#fileSelect").val("");     

                $.alert({
                  icon: 'fa fa-check-circle',
                  title: 'สำเร็จ',
                  content: 'บันทึกรูปภาพเสร็จสิ้น',
                });
              }else{
                $.alert({
                  icon: 'fa fa-warning',
                  title: 'แจ้งเตือน',
                  content: 'โปรดลองอีกครั้ง',
                });
              }
            }
          });
        }else{
          $.alert({
            icon: 'fa fa-warning',
            title: 'ไฟล์มีขนาดใหญ่เกินไป',
            content: 'ไฟล์ขนาดเกิน 15 MB',
          });
        }
      }      
    }
  </script>
</head>

<body>
  <div id="wrapper">
    <!-- Sidebar -->
    <div id="sidebar-wrapper">
      <ul class="sidebar-nav" style="margin-top: 20px">
        <li class="sidebar-brand"><a id="sidebar-title" href="http://150.95.26.163:8080/gitmew/sale.html">PPS Auto Group</a></li>
        <li><a href="http://150.95.26.163:8080/gitmew/import.html">๐ สินค้าเข้า</a></li>
        <li><a href="http://150.95.26.163:8080/gitmew/manage_prod.html">๐ จัดการสินค้า</a></li>
        <li><a href="http://150.95.26.163:8080/gitmew/manage_cus.html">๐ จัดการลูกค้า</a></li>
        <li><a href="http://150.95.26.163:8080/gitmew/sale.html">๐ ทำรายการขาย</a></li>    
        <li><a href="http://150.95.26.163:8080/gitmew/manage_bill.html">๐ รายการขายย้อนหลัง</a></li> 
        <li><a href="http://150.95.26.163:8080/gitmew/cash_record.html">๐ ตัดกะ</a></li>                   
        <li><a href="#" onclick="logout()">๐ ออกจากระบบ ๐</a></li>
      </ul>
    </div>
    <!-- End sidebar -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-md navbar-dark mb-4 rounded" style="background: #87ceeb;">
        <div class="clearfix">
          <a href="#menu-toggle" class="navbar-brand " id="menu-toggle">รายการ</a>
        </div>
        <div class="collapse navbar-collapse justify-content-md-center" id="navbarCollapse">
          <h3 id="nav-title">จัดการสินค้า</h3>
        </div>
      </nav>
      <!-- End Navbar -->
      <div class="container-fullwidth justify-content-center">
        <!-- 3 Search -->
        <div class="row">
          <div class="col-2"></div>
          <div class="col-2 text-center">
            บาร์โค๊ด
          </div>
          <div class="col-3 text-center">
            ชื่อสินค้า
          </div>
          <div class="col-2 text-center">
            ประเภท
          </div>
          <div class="col-3 text-center"></div>
        </div>
        <div class="row">
          <div class="col-1"></div>
          <div class="col-1 text-right">
            <p style="padding-top: 5px; font-size: 120%;">ค้นหา :
              <p/>
          </div>
          <div class="col-2 text-center">
            <input id="search-barcode" type="number" class="form-control text-center no-spin">
          </div>
          <div class="col-3 text-center">
            <input id="search-name" type="text" class="form-control text-center">
          </div>
          <div class="col-2 text-center">
            <input id="search-type" type="text" class="form-control text-center">
          </div>
          <div class="col-3 text-left">
            <button id='btn-search' class="btn btn-success btn-md" onclick="search()">ค้นหา</button>
            <button class="btn btn-info btn-md" onclick="add_prod();">เพิ่มสินค้า</button>
            <button class="btn btn-primary btn-md" onclick="showall()">แสดงทั้งหมด</button>
          </div>
        </div>
      </div>
      <hr style="width: 90%;">
      <!-- Header -->
      <div class="container-fullwidth justify-content-center" style="max-height: 100vh-70px;">
        <div class="row" style="padding-right: 40px; padding-left: 40px;">
          <div class="col-2 text-center">บาร์โค้ด</div>
          <div class="col-3 text-center">
            <a href="#" style="color: black;" onclick="click_sort('prod_name')">ชื่อสินค้า
              <i id="i-prod_name" class="fa fa-sort-down" style="vertical-align: top; margin-left:2px;" hidden></i>
            </a>
          </div>
          <div class="col-1 text-center">
            <a href="#" style="color: black;" onclick="click_sort('prod_type_name')">ประเภท
              <i id="i-prod_type_name" class="fa fa-sort-down" style="vertical-align: top; margin-left:2px;"  hidden></i>
            </a>
          </div>
          <div class="col-1 text-center" style="padding-left: 0px;">จน. (ร้านใหม่)</div>
          <div class="col-1 text-center" style="padding-left: 0px;">คลังสินค้า</div>
          <div class="col-1 text-center">หน่วย</div>
          <div class="col-1 text-center">
            <a href="#" style="color: black;" onclick="click_sort('prod_cost')">ทุน
              <i id="i-prod_cost" class="fa fa-sort-down" style="vertical-align: top; margin-left:2px;"  hidden></i>
            </a>
          </div>
          <div class="col-1 text-center">
            <a href="#" style="color: black;" onclick="click_sort('prod_price')">ราคา
              <i id="i-prod_price" class="fa fa-sort-down" style="vertical-align: top; margin-left:2px;"  hidden></i>
            </a>
          </div>
        </div><br>

        <ul class="list-group" style="padding-right: 20px; padding-left: 20px;">
          <!-- Append text html -->
        </ul> <br>

      </div>

      <nav id="nav-pagination">
        <ul class="pagination justify-content-center">
          <li id="li-prev" class="page-item disabled">
            <a class="page-link" href="#" aria-label="Previous" onclick="prev();">
              <span aria-hidden="true">&laquo;</span>
              <span class="sr-only">Previous</span>
            </a>
          </li>
          <li id="pg-st" class="page-item active">
            <a class="page-link scroll_to" href="#" onclick="pagination('st')">1</a>
          </li>
          <li id="pg-nd" class="page-item">
            <a class="page-link scroll_to" href="#" onclick="pagination('nd')">2</a>
          </li>
          <li id="pg-rd" class="page-item">
            <a class="page-link scroll_to" href="#" onclick="pagination('rd')">3</a>
          </li>
          <li id="li-next" class="page-item">
            <a class="page-link" href="#" aria-label="Next" onclick="next();">
              <span aria-hidden="true">&raquo;</span>
              <span class="sr-only">Next</span>
            </a>
          </li>
        </ul>
      </nav>
    </div>
    <!-- End page content wrapper -->

    <!-- info Modal -->
    <div class="modal fade" id="infoModal">
      <div class="modal-dialog modal-lg modal-dialog-top">
        <div class="modal-content">
          <div class="col-12 text-center" style="margin-top: 15px;">
            <h4 id='info-prod_name'>สินค้า 1</h4>
          </div>
          <!-- Modal Header -->
          <div class="row" style="margin-top: 15px;">
            <div class="col-3"></div>
            <div class="col-2 text-right pt">
              <h5 id="iftt-1-1" class="modal-title udl">จำนวน</h5>
            </div>
            <div class="col-2 text-center pt" style="border-right: 1px solid; border-left: 1px solid;">
              <h5 id="iftt-1-2"  class="modal-title">ลูกค้า</h5>
            </div>
            <div class="col-2 text-left pt">
              <h5 id="iftt-1-3"  class="modal-title">เพิ่มภาพ</h5>
            </div>
            <div class="col-3"></div>
          </div>
          <hr style="width: 70%;">

          <!-- info-amt -->
          <div id="info-amt" class="modal-body">
            <!-- Main amt -->
            <div class="row">
              <div class="col-12 text-center">
                <label class="radio-inline">
                  <input id="radio-1" type="radio" name="optradio" value="12"> 12</label>
                <label class="radio-inline">
                  <input id="radio-2" type="radio" name="optradio" value="50"> 50</label>
                <label class="radio-inline">
                  <input id="radio-3" type="radio" name="optradio" value="100"> 100</label>
                <label class="radio-inline">
                  <input id="radio-4" type="radio" name="optradio" value="200"> 200</label>
              </div>
            </div> <br>
            <div class="row">
              <div class="col-3"></div>
              <div class="col-3 text-center">
                <input id='input-unit' type="number" class="form-control text-center no-spin" placeholder="กำหนดจำนวน">
              </div>
              <div class="col-3 text-center">
                <input id='input-unit-price' type="number" class="form-control text-center no-spin" placeholder="ราคาต่อหน่วย">
              </div>
              <div class="col-2 text-center" style="margin-top: 6px;">
                <button class="btn btn-sm btn-success" onclick="add_unit();">เพิ่ม</button>
              </div>
              <div class="col-1"></div>
            </div><br>
            <div id="show-amt-container" class="container">
              <!-- Append after click เพิ่ม -->
            </div><br>
            <!-- Modal footer -->
            <div class="col-12 text-center">
              <button type="button" class="btn btn-success" onclick="save_unit();">บันทึก <i class="fa fa-save"></i></button>
              <button type="button" class="btn btn-primary" onclick="edit_unit();">แก้ไข <i class="fa fa-edit"></i></button>
              <button type="button" class="btn btn-danger" onclick="del_unit();">ลบ <i class="fa fa-close"></i></button>
            </div>
            <br>
          </div>

          <!-- info-cus -->
          <div id="info-cus" class="modal-body" hidden>
            <div class="row">
              <div class="col-3"></div>
              <div class="col-3 text-center">
                <input id="input-cus" type="text" class="form-control text-center" placeholder="เลือกลูกค้า">
              </div>
              <div class="col-3 text-center">
                <input id="input-cus-price" type="number" class="form-control text-center no-spin" placeholder="ราคาต่อหน่วย">
              </div>
              <div class="col-2 text-center" style="margin-top: 5px;">
                <button class="btn btn-sm btn-success" onclick="add_cus();">เพิ่ม</button>
              </div>
              <div class="col-1"></div>
            </div>
            <br>
            <div id="show-cus-container" class="container">
              <!-- Append after click เพิ่ม -->
            </div><br>
            <!-- Modal footer -->
            <div class="col-12 text-center">
              <button type="button" class="btn btn-success" onclick="save_cus();">บันทึก <i class="fa fa-save"></i></button>
              <button type="button" class="btn btn-primary" onclick="edit_cus();">แก้ไข <i class="fa fa-edit"></i></button>
              <button type="button" class="btn btn-danger" onclick="del_cus();">ลบ <i class="fa fa-close"></i></button>
            </div>
            <br>
          </div>

          <!-- info-pic -->
          <div id="info-pic" class="modal-body" hidden>
            <div class="file-upload" style="width: 70%; margin: auto;">
              <div class="file-select">
                <div class="file-select-button" id="fileName" style="font-size: 120%; font-family: 'Prompt', sans-serif;">เลือกไฟล์อัพโหลด</div>
                <div class="file-select-name" id="noFile" style="font-size: 120%; font-family: 'Prompt', sans-serif;">วางไฟล์ที่นี่.. ..</div>
                <form id="imageUploadForm" method="post" enctype="multipart/form-data">
                  <input id="fileSelect" type="file" name="file" accept="image/*" rel="popover" data-img="">
                </form>
              </div>
            </div> <br>
            <div id="row-img" class="row" hidden>
              <div class="col-12 text-center">
               <img id='img' src="" alt="" style="width: 400px; height: 400px;">
              </div>
            </div> <br>
            <!-- Modal footer -->
            <div class="col-12 text-center">
              <button type="button" class="btn btn-success" onclick="save_pic();">บันทึก <i class="fa fa-save"></i></button>
            </div>
            <br>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- End Wrapper -->

  <!-- Menu Toggle -->
  <script>
    // Menu Toggle
    $("#menu-toggle").click(function(e) {
      e.preventDefault();
      $("#wrapper").toggleClass("toggled");

      if ($("#menu-toggle").text() == "รายการ") {
        $("#menu-toggle").text("กลับ");
      } else if ($("#menu-toggle").text() == "กลับ") {
        $("#menu-toggle").text("รายการ");
      }
    });

    $('h5').click(function(event) {
      var str_id = $(this).attr('id');
      var arr = str_id.split('-');
      $(this).addClass('udl');
      // arr[2] is h4 click position
      for(i = 1; i <= 3; i++){
        if(i == arr[2]){
          continue;
        } 
        else{
          $("#iftt-"+arr[1]+"-"+i).removeClass('udl');
          if(arr[2] == '1'){
            // click amt // show amt
            $("#info-amt").prop('hidden', false);
            $("#info-cus").prop('hidden', true);
            $("#info-pic").prop('hidden', true);
          }else if(arr[2] == '2'){
            // click amt // show amt
            $("#info-amt").prop('hidden', true);
            $("#info-cus").prop('hidden', false);
            $("#info-pic").prop('hidden', true);
          }else if(arr[2] == '3'){
            // click amt // show amt
            $("#info-amt").prop('hidden', true);
            $("#info-cus").prop('hidden', true);
            $("#info-pic").prop('hidden', false);
          }
        }
      }
    });

    //Select file
    $('#fileSelect').bind('change', function() {
      var filename = $("#fileSelect").val();
      if (/^\s*$/.test(filename)) {
        // no file
        $(".file-upload").removeClass('active');
        $("#noFile").text("วางไฟล์ที่นี่.. ..");
      } else {
        readURL(this); //set data-img of ch
        $(".file-upload").addClass('active');
        $("#noFile").text(filename.replace("C:\\fakepath\\", ""));

        /*$('#fileSelect[rel=popover]').popover({
          html: true,
          trigger: 'hover',
          placement: 'right',
          content: function() {
            return '<img src=' + $(this).data('img') + '>';
          }
        });*/
      }
    });

    // Radio Check!!
    var is_checked = "null";
    $(function(){
      $('input[type="radio"]').click(function(){
        if ($(this).is(':checked')){
          if(is_checked == $(this).attr('id')){
            $(':radio').each(function () {
                $(this).removeAttr('checked');
                $('input[type="radio"]').prop('checked', false);
                $("#input-unit").prop('disabled', false);
              });
          }else{
            $("#input-unit").prop('disabled', true);
          }is_checked = $(this).attr('id');
        }
      });
    });
  </script>
</body>

</html>
